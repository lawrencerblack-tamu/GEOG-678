/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../core/Logger","../../../geometry/support/spatialReferenceUtils","../../../layers/support/infoFor3D","../../ViewingMode"],(function(e,t,i,r,s){"use strict";const o="esri.views.layers.support.editableLayerViews";function a(e,a){const{associatedLayer:n}=e,d=n?.infoFor3D;if(!!!d)return!1;const{supportedFormats:l,queryFormats:c}=d,g=r.getMimeTypeFormatId("model/gltf-binary",l)??r.getFilenameFormatId("glb",l);if(!(null!=g&&c.includes(g)))return t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because it does not support GLB queries.`),!1;const u=e.spatialReference,p=n.spatialReference;if(!i.equals(u,p))return t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${u.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${p.wkid}).`),!1;const f=n.sourceJSON.sourceSpatialReference;if(!(null==f||i.equals(f,p)))return t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${p.wkid}) is different from its source spatial reference (wkid:${f.wkid}).`),!1;const{view:{spatialReference:w,state:{viewingMode:y}}}=a,m=i.isGeographic(u),$=y===s.ViewingMode.Global;if(m&&!$)return t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${u.wkid}) is geographic. Please consider changing the viewing mode to global.`),!1;if(!m&&$)return t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${u.wkid}) is projected. Please consider changing the viewing mode to local.`),!1;return!!(i.equals(u,w)||$&&i.isWebMercator(w)&&i.isWGS84(u))||(t.getLogger(o).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${u.wkid}) does not match the view spatial reference (wkid:${w.wkid}).`),!1)}e.isGeometryEditableSceneLayer=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
