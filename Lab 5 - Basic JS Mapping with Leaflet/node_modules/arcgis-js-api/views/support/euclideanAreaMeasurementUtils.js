/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../core/quantityUtils","../../core/unitUtils","../../chunks/earcut","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","../../geometry/projection/projectVectorToVector","../../geometry/support/plane","../../geometry/support/triangle","./measurementUtils"],(function(e,t,r,n,o,c,a,l,i,u){"use strict";function s(e,t=m()){return p(e,t)}function f(e,t=m()){return p(e,t,!1)}function p(e,n,s=e.hasZ){const f=u.computeEuclideanMeasurementSR(e.spatialReference),p=r.areaUnitFromSpatialReference(f);if(null==p)return null;const m=(e,t)=>!(t.length<2)&&(o.set(e,t[0],t[1],s&&t[2]||0),!0);let A=0;for(const t of e.rings){const r=t.length;if(r<3)continue;const{positionsWorldCoords:u}=n;for(;u.length<r;)u.push(c.create());const s=d,p=o.set(g,0,0,0),P=1/r;for(let n=0;n<r;n++){if(!m(s,t[n]))return null;if(!a.projectVectorToVector(s,e.spatialReference,u[n],f))return null;o.scaleAndAdd(p,p,u[n],P)}const y=l.fromPoints(u[0],u[1],p,l.wrap());if(0===o.squaredLength(l.getNormal(y)))continue;for(let e=0;e<r;e++)l.projectPointLocal(y,p,u[e],u[e]);const j=h(u);for(let e=0;e<j.length;e+=3)A+=i.areaPoints2d(u[j[e]],u[j[e+1]],u[j[e+2]])}return t.createArea(A,p)}const d=c.create(),g=c.create();function m(){return{positionsWorldCoords:[]}}function h(e){return n.earcut(A(e),[],2)}function A(e){const t=new Float64Array(2*e.length);for(let r=0;r<e.length;++r){const n=e[r],o=2*r;t[o]=n[0],t[o+1]=n[1]}return t}e.computeEuclideanPlanarArea=p,e.createEuclideanPlanarAreaCache=m,e.euclideanHorizontalPlanarArea=f,e.euclideanPlanarArea=s,e.triangulate=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
