/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../core/Cyclical","../../core/quantityUtils","../../core/unitUtils","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","../../geometry/projection/projectVectorToVector","../../geometry/support/geodesicUtils","../../geometry/support/spatialReferenceUtils"],(function(e,t,r,o,i,c,n,a,l,s,u){"use strict";var g;function d(e,t){if(null==e||null==t)return;const o=p(e,t);return null!=o?r.createAngle(o,"radians","geographic"):void 0}e.DirectionMode=void 0,(g=e.DirectionMode||(e.DirectionMode={})).Absolute="absolute",g.Relative="relative",g.RelativeBilateral="relative-bilateral";const p=(()=>{const e=a.create(),t=a.create();return(r,o)=>(n.set(e,r.x,r.y,r.z??0),n.set(t,o.x,o.y,o.z??0),v(e,t,r.spatialReference,o.spatialReference))})(),v=(()=>{const e=c.create(),t=a.create(),r=a.create();return(a,g,d,p)=>{if(n.exactEquals(a,g))return;const v=s.geodesicCompatibleSpatialReference(d),f=s.geodesicCompatibleSpatialReference(p);if(v&&f&&u.equals(v,f)&&l.projectVectorToVector(a,d,t,v)&&l.projectVectorToVector(g,p,r,f)){const{azimuth:e}=s.inverseGeodeticSolver(D,t,r,v);return null!=e?o.convertUnit(e,"degrees","radians"):void 0}e[0]=g[0]-a[0],e[1]=g[1]-a[1];let h=i.angle(c.UNIT_Y,e);return e[0]<0&&(h=b-h),h}})();function f(t,r,o,i=e.DirectionMode.Absolute){if(r&&o)switch(i){case e.DirectionMode.Absolute:return d(r,o);case e.DirectionMode.Relative:return m(h(t,r,o),e.DirectionMode.Relative);case e.DirectionMode.RelativeBilateral:return m(h(t,r,o),e.DirectionMode.RelativeBilateral)}}function h(e,t,o){if(!e||!t||!o)return;const i=p(e,t),c=p(t,o);return null!=i&&null!=c?r.createAngle(c-i,"radians","geographic"):void 0}function m(t,o){if(null==t)return;const i=R(t);switch(o){case e.DirectionMode.Absolute:{const e=y.normalize(i,0,!0);return r.createAngle(e,"degrees","geographic")}case e.DirectionMode.Relative:{let e=V.normalize(i,0,!0);return-180===e&&(e=180),r.createAngle(e,"degrees","geographic")}case e.DirectionMode.RelativeBilateral:{const e=Math.abs(V.normalize(i,0,!0));return r.createAngle(e,"degrees","geographic")}}}const M=(()=>{const e=a.create();return(t,i,c,a,u,g="geodesic")=>{n.copy(e,i);const d=R(u);if("geodesic"===g){const r=s.geodesicCompatibleSpatialReference(c);if(r&&l.projectVectorToVector(e,c,e,r))return s.directGeodeticSolver(t,e,d,a,r),t[2]=i[2],!!l.projectVectorToVector(t,r,t,c)}const p=r.convertRotationType(d,"geographic","arithmetic"),v=o.convertUnit(p,"degrees","radians"),f=i[0]+a*Math.cos(v),h=i[1]+a*Math.sin(v),m=i[2];return n.set(t,f,h,m),!0}})();function R(e){return null!=e?r.convertRotationType(o.convertUnit(e.value,e.unit,"degrees"),e.rotationType,"geographic"):void 0}const D=new s.InverseGeodeticSolverResult,b=2*Math.PI,y=t.cyclicalDegrees,V=new t.Cyclical(-180,180);e.directionBetweenPoints=d,e.directionForVertices=f,e.getDegreesGeographic=R,e.getNormalizedDirection=m,e.pointFromDistanceAlongAzimuth=M,e.radiansGeographicBetweenVec=v,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
