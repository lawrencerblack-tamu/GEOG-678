/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../core/quantityUtils","../../core/unitUtils","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","../../geometry/projection/projectVectorToVector","../../geometry/support/spatialReferenceUtils","./measurementUtils"],(function(e,t,n,r,i,c,l,a){"use strict";var o;function u(e){return f(e,o.Direct)}function s(e){return f(e,o.Horizontal)}function f(e,r){const{hasZ:i,spatialReference:c}=e,l=a.computeEuclideanMeasurementSR(c);let u=0;const s=n.lengthUnitFromSpatialReference(l);if(null==s)return null;const f=r===o.Direct?R:m;for(const t of e.paths){if(t.length<2)continue;const e=t.length-1;for(let n=0;n<e;++n){const e=t[n];S[0]=e[0],S[1]=e[1],S[2]=i?e[2]:0;const r=t[n+1];Z[0]=r[0],Z[1]=r[1],Z[2]=i?r[2]:0;const l=f(S,Z,c);if(null==l)return null;u+=l.value}}return t.createLength(u,s)}function h(e,t){const{spatialReference:n}=e;return l.equals(n,t.spatialReference)?(S[0]=e.x,S[1]=e.y,S[2]=e.hasZ?e.z:0,Z[0]=t.x,Z[1]=t.y,Z[2]=t.hasZ?t.z:0,D(S,Z,n)):null}function d(e,t){const{spatialReference:n}=e;return l.equals(n,t.spatialReference)?(S[0]=e.x,S[1]=e.y,S[2]=e.hasZ?e.z:0,Z[0]=t.x,Z[1]=t.y,Z[2]=t.hasZ?t.z:0,R(S,Z,n)):null}function g(e,t){const{spatialReference:n}=e;return l.equals(n,t.spatialReference)?(S[0]=e.x,S[1]=e.y,S[2]=e.hasZ?e.z:0,Z[0]=t.x,Z[1]=t.y,Z[2]=t.hasZ?t.z:0,m(S,Z,n)):null}function p(e,t){const{spatialReference:n}=e;return l.equals(n,t.spatialReference)?(S[0]=e.x,S[1]=e.y,S[2]=e.hasZ?e.z:0,Z[0]=t.x,Z[1]=t.y,Z[2]=t.hasZ?t.z:0,V(S,Z,n)):null}function z(e){return null!=e?v(e.hasZ?e.z:0,e.spatialReference):null}function v(e,r){const i=n.verticalLengthUnitFromSpatialReference(r);return null!=i?t.createLength(e??0,i):null}function D(e,n,r){const i=L(e,n,r);return null!=i?{direct:t.createLength(i.direct,i.unit),horizontal:t.createLength(i.horizontal,i.unit),vertical:t.createLength(i.vertical,i.unit)}:null}function R(e,n,r){const i=L(e,n,r,o.Direct);return null!=i?t.createLength(i.direct,i.unit):null}function m(e,n,r){const i=L(e,n,r,o.Horizontal);return null!=i?t.createLength(i.horizontal,i.unit):null}function y(e,n,r){const i=L(e,n,r,o.Vertical);return null!=i?t.createLength(Math.abs(i.verticalSigned),i.unit):null}function V(e,n,r){const i=L(e,n,r,o.Vertical);return null!=i?t.createLength(i.verticalSigned,i.unit):null}function L(e,t,i,l){const u=a.computeEuclideanMeasurementSR(i),s=n.lengthUnitFromSpatialReference(u);if(null==s)return null;const f=t[2]-e[2];if(l===o.Vertical)return{verticalSigned:f,unit:s};if(!c.projectVectorToVector(e,i,x,u)||!c.projectVectorToVector(t,i,H,u))return null;if(l===o.Direct){return{direct:r.distance(H,x),unit:s}}if(r.set(U,e[0],e[1],t[2]),!c.projectVectorToVector(U,i,U,u))return null;const h=r.distance(U,H);if(l===o.Horizontal)return{horizontal:h,unit:s};return{direct:r.distance(H,x),horizontal:h,vertical:Math.abs(f),unit:s}}!function(e){e[e.Direct=0]="Direct",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical"}(o||(o={}));const S=i.create(),Z=i.create(),x=i.create(),H=i.create(),U=i.create();e.elevationFromPoint=z,e.elevationFromZ=v,e.euclideanDirectDistance=R,e.euclideanDirectDistanceBetweenPoints=d,e.euclideanDistance=D,e.euclideanDistanceBetweenPoints=h,e.euclideanHorizontalDistance=m,e.euclideanHorizontalDistanceBetweenPoints=g,e.euclideanHorizontalLength=s,e.euclideanLength=u,e.verticalDistance=y,e.verticalSignedDistance=V,e.verticalSignedDistanceBetweenPoints=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
