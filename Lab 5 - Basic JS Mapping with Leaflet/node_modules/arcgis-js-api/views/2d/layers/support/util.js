/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../core/jsonMap","../../engine/webgl/effects/highlight/HighlightGradient","../../engine/webgl/effects/highlight/MultiHighlightGradient","../../engine/webgl/shaderGraph/techniques/featureTechniqueUtils"],(function(e,t,i,n,l){"use strict";const s=new t.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function a(e){return s.toJSON(e)}function o(e,t,i){const n=[],l=[];let s=0,a=0;for(const o of e){const e=a;let r=o[0][0],h=o[0][1];n[a++]=r,n[a++]=h;let g=0;for(let t=1;t<o.length;++t){const e=r,i=h;r=o[t][0],h=o[t][1],g+=h*e-r*i,n[a++]=r,n[a++]=h}t(g/2),g>0?(e-s>0&&(i(s,e,n,l),s=e),l.length=0):g<0&&e-s>0?l.push(.5*(e-s)):a=e}a-s>0&&i(s,a,n,l)}function r(e){const{bandCount:t,attributeTable:i,colormap:n,pixelType:l}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=n||"u8"===l||"s8"===l)}function h(e,t){return"single"===e?.type&&t.multiHighlightEnabled&&(e.destroy(),e=null),"multi"!==e?.type||t.multiHighlightEnabled||(e.destroy(),e=null),e||(e=t.multiHighlightEnabled?new n.MultiHighlightGradient:new i),e.setHighlightOptions(t),e}function g(e,t,i){const{painter:n,highlightGradient:s}=e,{highlight:a}=n.effects;if(!s)return;const o=e.passOptions,r=s.getReasonsWithGradients();for(let h=0;h<r.length;h++){const s={...e,passOptions:{type:"highlight",activeGradient:r[h].activeGradient,activeReasons:r[h].activeReasons,stepType:"burn",highlightAll:t}};if(a.bind(s),i(s),h<r.length-1){let n=0;for(let e=h+1;e<r.length;e++)n|=r[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:r[h].activeGradient,activeReasons:n,stepType:"clear",highlightAll:t}})}const o={...e,passOptions:{type:"highlight",activeGradient:r[h].activeGradient,activeReasons:r[h].activeReasons,stepType:"draw",highlightAll:t}};n.setPipelineState(l.getFeaturePipelineState(e)),n.updatePipelineState(e.context),a.draw(o),a.unbind()}e.passOptions=o}e.analyzeRings=o,e.canUseMajorityInterpolationOnDataSource=r,e.createOrReuseHighlightGradient=h,e.renderHighlight=g,e.toJSONGeometryType=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
