/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/maybe","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./handlers/DoubleClickZoom","./handlers/DoubleTapDragZoom","./handlers/DragPan","./handlers/DragRotate","./handlers/GamepadNavigation","./handlers/KeyPan","./handlers/KeyRotate","./handlers/KeyZoom","./handlers/MouseWheelZoom","./handlers/PinchAction","../../input/BrowserEventSource","../../input/InputManager","../../input/handlers/PreventContextMenu","../../input/recognizers/DoubleTapDrag","../../input/recognizers/Drag","../../input/recognizers/ImmediateDoubleClick","../../input/recognizers/PointerClickHoldAndDrag","../../input/recognizers/SingleAndDoubleClick"],(function(e,t,n,i,o,r,a,s,c,u,l,p,w,h,d,g,v,m,y,D,_,b,M,P,A,C,k){"use strict";const T={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let z=class extends t{initialize(){const e=()=>this.view?.ready;this.addHandles([i.when((()=>!e()),(()=>this._disconnect())),i.when(e,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=n.destroyMaybe(this._inputManager)}_connect(){const e=this.view.surface,t=new D.BrowserEventSource(e,this.view.input),n=[new A.ImmediateDoubleClick,new C.PointerClickHoldAndDrag,new k.SingleAndDoubleClick,new P.Drag(this.view.navigation),new M.DoubleTapDrag],o=new _.InputManager({eventSource:t,recognizers:n});o.installHandlers("prevent-context-menu",[new b.PreventContextMenu],_.ViewEventPriorities.INTERNAL),o.installHandlers("navigation",[new y.PinchRotateAndZoom(this.view),new h.GamepadNavigation(this.view),new m.MouseWheelZoom(this.view),new u.DoubleClickZoom(this.view),new u.DoubleClickZoom(this.view,[T.counter]),new p.DragPan(this.view,"primary"),new d.KeyPan(this.view,T.pan),new v.KeyZoom(this.view,T.zoom),new g.KeyRotate(this.view,T.rotate),new w.DragRotate(this.view,"secondary"),new l.DoubleTapDragZoom(this.view,"touch")],_.ViewEventPriorities.INTERNAL),this.view.viewEvents.connect(o),this._source=t,this._inputManager=o,i.watch((()=>this.view?.navigation?.browserTouchPanEnabled),(e=>{this._source&&(this._source.browserTouchPanningEnabled=!e)}),i.initial)}get test(){return{inputManager:this._inputManager}}};e.__decorate([o.property()],z.prototype,"view",void 0),e.__decorate([o.property()],z.prototype,"latestPointerType",null),e.__decorate([o.property()],z.prototype,"latestPointerLocation",null),e.__decorate([o.property()],z.prototype,"multiTouchActive",null),z=e.__decorate([c.subclass("esri.views.2d.input.MapViewInputManager")],z);return z}));
