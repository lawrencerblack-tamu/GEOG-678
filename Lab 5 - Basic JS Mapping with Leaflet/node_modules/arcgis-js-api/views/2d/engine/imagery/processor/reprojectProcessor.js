/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../../webgl/rasterUtils"],(function(e,r){"use strict";const t={vsPath:"raster/common",fsPath:"raster/reproject",attributes:new Map([["a_position",0],["a_texcoord",1]])};function i(e,r){const{painter:i}=e,s=[],{interpolation:n,transformGrid:o}=r,a=e.rasterFunction?.parameters;return"cubic"===n?s.push("bicubic"):"bilinear"===n&&(s.push("bilinear"),a?.requireNNEdge&&s.push("nnedge")),o&&(s.push("applyProjection"),1===o.spacing[0]&&s.push("lookupProjection")),i.materialManager.getProgram(t,s)}function s(t,i,s){const{names:n,textures:o}=s.getTextures({forProcessing:!0});r.setTextures(t.context,i,n,o),i.setUniform1f("u_scale",1),i.setUniform2fv("u_offset",[0,0]),i.setUniform2fv("u_coordScale",[1,1]),i.setUniformMatrix3fv("u_dvsMat3",[2,0,0,0,2,0,-1,-1,0]),i.setUniform1i("u_flipY",0),i.setUniform1f("u_opacity",1);const{width:a,height:f,source:c,transformGrid:u}=s;i.setUniform2fv("u_srcImageSize",[c.width,c.height]),i.setUniform2fv("u_targetImageSize",[a,f]),i.setUniform2fv("u_transformSpacing",u?u.spacing:e.ZEROS),i.setUniform2fv("u_transformGridSize",u?u.size:e.ZEROS)}return{createProgram:i,bindTextureAndUniforms:s}}));
