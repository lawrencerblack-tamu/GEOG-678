/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../../symbols/cim/constants"],(function(t,e){"use strict";function n(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e){return Math.sqrt(t*t+e*e)}function i(t){const e=s(t[0],t[1]);t[0]/=e,t[1]/=e}function r(t,e){return s(t[0]-e[0],t[1]-e[1])}function h(t,e){return t[e+1]}function a(t){return t.length-1}function u(t){let e=0;for(let n=0;n<a(t);n++)e+=d(t,n);return e}function d(t,e,n=1){let[s,i]=h(t,e);return[s,i]=[Math.round(s),Math.round(i)],Math.sqrt(s*s+i*i)*n}class o{constructor(t,e,n,s,i){this._segments=t,this._index=e,this._distance=n,this._xStart=s,this._yStart=i,this._done=!1}static create(t){return new o(t,0,0,t[0][0],t[0][1])}clone(){return new o(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let n=Math.acos(e);return t>0&&(n=2*Math.PI-n),n}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<a(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const n=this.backwardLength;if(t<=n)return this._distance=(n-t)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>t)return this._seekBackwards(t-s);s+=this.length}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>t)return this.seek(t-n,e);n+=this.length}return this._distance=1,e?this:null}}function c(t,n,s,i=!0){const r=u(t),h=o.create(t),a=r/2;if(!i)return h.seek(a),void(Math.abs(h.x)<e.maxTileCoordValue&&Math.abs(h.y)<e.maxTileCoordValue&&s(h.clone(),0,a+0*n,r));const d=Math.max((r-n)/2,0),c=Math.floor(d/n),l=a-c*n;h.seek(l);for(let u=-c;u<=c;u++)Math.abs(h.x)<e.maxTileCoordValue&&Math.abs(h.y)<e.maxTileCoordValue&&s(h.clone(),u,a+u*n,r),h.seek(n)}function l(t,e,n){_(n,e,u(t),o.create(t),0)}function _(t,e,n,s,i){if(n<e)return;const r=s.clone().seek(n/2);if(null==r)return;t(r.clone(),n,i),n=(n-e)/2;const h=r.seek(e/2);_(t,e,n,s,i+1),_(t,e,n,h,i+1)}function g(t,e){const n=e;for(let s=0;s<t.length;s++){let e=t[s];x(e,n);const i=[];i.push(e[0]);for(let t=1;t<e.length;t++){const[n,s]=e[t-1],[r,h]=e[t],a=r-n,u=h-s;i.push([a,u])}t[s]=i,e=i}return t}function x(t,e){const s=1e-6;if(e<=0)return;const h=t.length;if(h<3)return;const a=[];let u=0;a.push(0);for(let n=1;n<h;n++)u+=r(t[n],t[n-1]),a.push(u);e=Math.min(e,.2*u);const d=[];d.push(t[0][0]),d.push(t[0][1]);const o=t[h-1][0],c=t[h-1][1],l=n([0,0],t[0],t[1]);i(l),t[0][0]+=e*l[0],t[0][1]+=e*l[1],n(l,t[h-1],t[h-2]),i(l),t[h-1][0]+=e*l[0],t[h-1][1]+=e*l[1];for(let n=1;n<h;n++)a[n]+=e;a[h-1]+=e;const _=.5*e;for(let n=1;n<h-1;n++){let i=0,r=0,u=0;for(let h=n-1;h>=0&&!(a[h+1]<a[n]-_);h--){const d=_+a[h+1]-a[n],o=a[h+1]-a[h],c=a[n]-a[h]<_?1:d/o;if(Math.abs(c)<s)break;const l=c*c,g=c*d-.5*l*o,x=c*o/e,f=t[h+1],y=t[h][0]-f[0],m=t[h][1]-f[1];i+=x/g*(f[0]*c*d+.5*l*(d*y-o*f[0])-l*c*o*y/3),r+=x/g*(f[1]*c*d+.5*l*(d*m-o*f[1])-l*c*o*m/3),u+=x}for(let d=n+1;d<h&&!(a[d-1]>a[n]+_);d++){const h=_-a[d-1]+a[n],o=a[d]-a[d-1],c=a[d]-a[n]<_?1:h/o;if(Math.abs(c)<s)break;const l=c*c,g=c*h-.5*l*o,x=c*o/e,f=t[d-1],y=t[d][0]-f[0],m=t[d][1]-f[1];i+=x/g*(f[0]*c*h+.5*l*(h*y-o*f[0])-l*c*o*y/3),r+=x/g*(f[1]*c*h+.5*l*(h*m-o*f[1])-l*c*o*m/3),u+=x}d.push(i/u),d.push(r/u)}d.push(o),d.push(c);for(let n=0,i=0;n<h;n++)t[n][0]=d[i++],t[n][1]=d[i++]}t.SegmentCursor=o,t.pathDivide=c,t.pathLength=u,t.pathSubdivide=l,t.segmentAt=h,t.segmentCount=a,t.segmentLength=d,t.smoothPaths=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
