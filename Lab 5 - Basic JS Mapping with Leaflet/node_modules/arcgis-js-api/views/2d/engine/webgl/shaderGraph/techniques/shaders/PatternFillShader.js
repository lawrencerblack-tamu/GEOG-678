/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../../../chunks/tslib.es6","../../GraphShaderModule","../../graph/glsl","./AFeatureShader","./FillShader","./LocalTileOffset","./MosaicInfo"],(function(t,e,r,o,i,a,l,n){"use strict";class s extends a.FillVertexInput{}e.__decorate([r.location(5,o.Vec4)],s.prototype,"tlbr",void 0),e.__decorate([r.location(6,o.Float)],s.prototype,"inverseRasterizationScale",void 0);class u extends i.FeatureFragmentInput{}function c(t){const e=new o.Float(1),r=new o.Float(0);return new o.Mat3(e.divide(t.x),r.divide(t.y),0,o.negate(r.divide(t.x)),e.divide(t.y),0,0,0,1)}function d(t,e){const r=e.tlbr.xy,i=e.tlbr.zw,a=i.x.subtract(r.x),l=r.y.subtract(i.y),n=new o.Vec2(a,l).multiply(e.inverseRasterizationScale),s=n.multiply(t.view.requiredZoomFactor),u=c(s),d=t.localTileOffset.getPatternOffsetAtTileOrigin(n).divide(s),p=new o.Vec3(e.pos,1);return{tileTextureCoord:u.multiply(p).xy.subtract(d),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function p(t,e){const r=o.mod(t.tileTextureCoord,new o.Float(1)),i=o.mix(t.tlbr.xy,t.tlbr.zw,r),a=o.texture2D(e.texture,i);return t.color.multiply(a)}class f extends a.FillShader{vertex(t,e){return{...super.vertex(t,e),...d(this,t)}}fragment(t){const e=p(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new o.Float(0))}}e.__decorate([r.uniform(n.MosaicInfo)],f.prototype,"mosaicInfo",void 0),e.__decorate([r.uniform(l.LocalTileOffset)],f.prototype,"localTileOffset",void 0),e.__decorate([e.__param(0,r.input(s)),e.__param(1,r.input(i.BaseHittestVertexInput))],f.prototype,"vertex",null),e.__decorate([e.__param(0,r.input(u))],f.prototype,"fragment",null),t.PatternFillFragmentInput=u,t.PatternFillShader=f,t.PatternFillVertexInput=s,t.getPatternFillFragmentColor=p,t.getPatternFillVertexData=d,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
