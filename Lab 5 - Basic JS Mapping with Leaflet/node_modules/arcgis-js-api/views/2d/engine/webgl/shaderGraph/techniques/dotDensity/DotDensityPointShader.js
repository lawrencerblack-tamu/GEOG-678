/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../../../chunks/tslib.es6","../../../definitions","../../GraphShaderModule","../../graph/glsl","../shaders/AFeatureShader","../shaders/ViewInfo"],(function(t,e,o,i,n,r,a){"use strict";class d extends i.VertexInput{}e.__decorate([i.location(0,n.Vec2)],d.prototype,"pos",void 0);class l extends r.FeatureFragmentInput{}class s extends i.UniformGroup{}e.__decorate([i.uniform(n.Float)],s.prototype,"dotSize",void 0);class p extends i.UniformGroup{}e.__decorate([i.uniform(n.Sampler2D)],p.prototype,"locations",void 0),e.__decorate([i.uniform(n.Float)],p.prototype,"pixelRatio",void 0),e.__decorate([i.uniform(n.Float)],p.prototype,"tileZoomFactor",void 0);const c=1e-6;class u extends i.GraphShaderModule{vertex(t){const e=new n.Mat3(1,0,0,0,-1,0,0,1,1).multiply(new n.Vec3(t.pos.xy.divide(o.tileSize),1)),i=n.texture2D(this.draw.locations,e.xy),r=n.max(this.instance.dotSize.divide(2),new n.Float(1));let a=new n.Float(0);a=a.add(n.step(i.a,new n.Float(c)).multiply(2));let d=r.add(this.instance.dotSize);const l=this.view.displayViewScreenMat3.multiply(new n.Vec3(t.pos.add(.5),1)),s=new n.Vec4(l.xy,a,1),p=this.instance.dotSize.divide(d),u=new n.Float(-1).divide(r.divide(d));return d=d.multiply(this.draw.pixelRatio.multiply(this.draw.tileZoomFactor)),{glPosition:s,glPointSize:d,color:i,ratio:p,invEdgeRatio:u}}fragment(t){const e=n.length(t.glPointCoord.subtract(.5)).multiply(2),o=n.smoothstep(new n.Float(0),new n.Float(1),t.invEdgeRatio.multiply(e.subtract(t.ratio)).add(1)),r=new i.FragmentOutput;return r.glFragColor=t.color.multiply(o),r}}e.__decorate([i.uniform(s)],u.prototype,"instance",void 0),e.__decorate([i.uniform(p)],u.prototype,"draw",void 0),e.__decorate([i.uniform(a.ViewInfo)],u.prototype,"view",void 0),e.__decorate([e.__param(0,i.input(d))],u.prototype,"vertex",null),e.__decorate([e.__param(0,i.input(l))],u.prototype,"fragment",null),t.DotDensityPointDrawUniforms=p,t.DotDensityPointFragmentInput=l,t.DotDensityPointInstanceUniforms=s,t.DotDensityPointShader=u,t.DotDensityPointVertexInput=d,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
