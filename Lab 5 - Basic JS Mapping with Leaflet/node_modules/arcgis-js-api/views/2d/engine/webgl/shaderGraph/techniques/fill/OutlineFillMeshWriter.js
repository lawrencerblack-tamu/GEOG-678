/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../../../geometry/GeometryCursor","../../../mesh/templates/templateUtils","./FillMeshWriter","./meshWriterUtils","../line/LineMeshWriter","../mesh/utils","../shaders/constants","../../../../../../webgl/enums"],(function(e,t,r,i,s,l,n,a,o){"use strict";const u={createComputedParams:e=>e,attributes:{...l.LineVertexSpec.attributes,bitset:{type:o.DataType.UNSIGNED_BYTE,count:1,pack:e=>0},color:{type:o.DataType.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>s.processColorInput(e)}}},c={createComputedParams:e=>e,attributes:{...l.LineVertexSpec.attributes,bitset:{type:o.DataType.UNSIGNED_BYTE,count:1,pack:e=>s.packBitset([[a.bitsetTypeFillOutline,!0]])},color:{type:o.DataType.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>s.processColorInput(e)}}};class p extends l.LineMeshWriter{constructor(){super(...arguments),this.vertexSpec=c}}class h extends i.FillMeshWriter{constructor(e,t,r,i){super(e,t,r,i),this.vertexSpec=u,this._lineMeshWriter=this._createOutlineWriter(e,t,r,i)}_createOutlineWriter(e,t,r,i){return new p(e,t,r,i)}_write(e,r,i){const s=i?.asOptimized()??r.readGeometryForDisplay(),l=this._clip(s);l&&(e.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(e,r,l),this._lineMeshWriter.writeLineVertices(e,t.GeometryCursor.fromOptimizedCIM(l,"esriGeometryPolyline"),r),e.recordEnd())}_clip(e){return e?r.clipMarshall(e,n.getLineClippingMargin(this.evaluatedMeshParams)):null}ensurePacked(e,t,r){super.ensurePacked(e,t,r),this._lineMeshWriter.ensurePacked(e,t,r)}enqueueRequest(e,t,r){super.enqueueRequest(e,t,r),this._lineMeshWriter.enqueueRequest(e,t,r)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}e.OutlineFillMeshWriter=h,e.OutlineFillOutlineMeshWriter=p,e.outlineFillVertexSpec_Fill=u,e.outlineFillVertexSpec_Outline=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
