/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../core/string","./typed/TypedShaderProgram"],(function(t,e,o){"use strict";class n{constructor(){this.computeAttributes={}}get locationsMap(){const t=new Map;for(const e in this.locations)t.set(e,this.locations[e].index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set(Object.keys(this.options));this._optionPropertyKeys=t}return this._optionPropertyKeys}get _transformFeedbackBindings(){return[]}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,o=Array.from(t.entries()).map((([t,e])=>`${t}.${e}`)).join("."),n=e.numericHash(o);this._locationInfo={hash:n,locations:t}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const[e,o]of this.locationsMap.entries())t.set("a_"+e,o);return t}getShaderKey(t,e,o){const n=Object.keys(o).filter((t=>o[t])).map((t=>`${t}_${o[t].toString()}`)).join("."),r=Object.keys(e).filter((t=>this.optionPropertyKeys.has(t))).join(".");return`${t.hash}.${n}.${r}`}getProgram(t,e,n,r){let i="",s="";for(const o in n)if(n[o]){const t="boolean"==typeof n[o]?`#define ${o}\n`:`#define ${o} ${n[o]}\n`;i+=t,s+=t}return i+=this.vertexShader,s+=this.fragmentShader,new o.TypedShaderProgram(i,s,this.renamedLocationsMap,this.locationInfo,this._getUniformBindings(e),this._transformFeedbackBindings)}_getUniformBindings(t){const e=[];for(const o in this.required){const t=this.required[o];e.push({uniformHydrated:null,shaderModulePath:o,uniformName:o,uniformType:t.type,uniformArrayElementType:r(t),uniformArrayLength:i(t)})}for(const o in t){const n=this.options[o];if(t[o])for(const t in n){const s=n[t];e.push({uniformHydrated:null,shaderModulePath:`${o}.${t}`,uniformName:t,uniformType:s.type,uniformArrayElementType:r(s),uniformArrayLength:i(s)})}}return e}}const r=t=>"array"===t.type?t.elementType?.type:void 0,i=t=>"array"===t.type?t.size:void 0;t.GLSLShaderModule=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
