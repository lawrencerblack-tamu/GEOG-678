/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../graph/glsl","./constants","./utils"],(function(t,n,e,i){"use strict";function l(t,e){return n.dot(t,n.normalize(e))}function u(t,e,i){const u=i.subtract(e),a=l(t.subtract(e),u),r=n.clamp(a.divide(n.length(u)),new n.Float(0),new n.Float(1));return n.distance(t,e.add(r.multiply(i.subtract(e))))}function a(t){const e=n.abs(t);return n.step(e.x.add(e.y).add(e.z),new n.Float(1.05))}function r(t,e,i,l){const u=new n.Mat3(i.x.multiply(l.y).subtract(l.x.multiply(i.y)),l.x.multiply(e.y).subtract(e.x.multiply(l.y)),e.x.multiply(i.y).subtract(i.x.multiply(e.y)),i.y.subtract(l.y),l.y.subtract(e.y),e.y.subtract(i.y),l.x.subtract(i.x),e.x.subtract(l.x),i.x.subtract(e.x)),a=e.x.multiply(i.y.subtract(l.y)),r=i.x.multiply(l.y.subtract(e.y)),s=l.x.multiply(e.y.subtract(i.y)),c=a.add(r).add(s);return new n.Float(1).divide(c).multiply(u.multiply(new n.Vec3(1,t)))}function s(t,e,i,l){return n.equal(a(r(t,e,i,l)),new n.Float(1))}function c(t,l,a,r){const c=a.subtract(l),o=r.subtract(l),y=i.cross2(c,o),d=n.and(n.lessThan(y,new n.Float(e.epsilonHitTest)),n.greaterThan(y,new n.Float(-e.epsilonHitTest)));return n.cond([n.and(n.not(d),s(t.xy,l,a,r)),new n.Float(-1)],[!0,()=>{const e=u(t,l,a),i=u(t,a,r),s=u(t,r,l);return n.min(n.min(e,i),s)}])}function o(t){return t.distance.add(1)}function y(t,e,i){const{viewMat3:l,tileMat3:u}=t.view,a=l.multiply(u),r=a.multiply(new n.Vec3(e.pos,1)),s=a.multiply(new n.Vec3(i.nextPos1,1)),o=a.multiply(new n.Vec3(i.nextPos2,1));return c(t.hittestRequest.position,r.xy,s.xy,o.xy)}function d(t,e,i){return n.distance(t,i).subtract(e)}t.distPointSegment=u,t.distPointTriangle=c,t.failHittest=o,t.hittestFill=y,t.hittestMarker=d,t.inTriangle=a,t.projectScalar=l,t.xyToBarycentric=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
