/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./Technique","./mesh/MeshWriter","./shaders/TestShader","../../../../../webgl/enums"],(function(e,t,r,i,s){"use strict";const o={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:s.CompareFunction.EQUAL,mask:255,op:{fail:s.StencilOperation.KEEP,zFail:s.StencilOperation.KEEP,zPass:s.StencilOperation.REPLACE}}}};class n extends t.Technique{constructor(){super(...arguments),this.meshWriter={name:"TestMeshWriter",constructor:c},this.shaders={geometry:new i.TestShader}}render(e,t){const{context:r,painter:i}=e,s=t.instance.getInput();i.setShader({shader:this.shaders.geometry,uniforms:{dataDrivenColor:s.geometry.dataDrivenColor,view:{zoomLevel:1}},defines:{returnRed:!1},optionalAttributes:t.instance.optionalAttributes,useComputeBuffer:!1}),i.setPipelineState(o),i.submitDraw(r,t)}}const a={createComputedParams:e=>e,attributes:{pos:{type:s.DataType.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:s.DataType.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:s.DataType.UNSIGNED_BYTE,count:1},size:{type:s.DataType.UNSIGNED_BYTE,count:1,packPrecisionFactor:10,pack:e=>.2},offset:{type:s.DataType.INT,count:2,packPrecisionFactor:10,packAlternating:{count:4,pack:()=>[[-1,1],[1,1],[-1,-1],[1,-1]]}},color:{type:s.DataType.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>e}}};class c extends r.MeshWriter{constructor(){super(...arguments),this.vertexSpec=a}_write(e,t){e.recordStart(this.instanceId,this.attributeLayout);const r=655360,i=e.vertexCount(),s=t.readXForDisplay(),o=t.readYForDisplay();this._writeVertex(e,r,s,o),e.indexWrite(i+0),e.indexWrite(i+1),e.indexWrite(i+2),e.indexWrite(i+1),e.indexWrite(i+3),e.indexWrite(i+2),e.recordEnd()}}e.TestMeshWriter=c,e.TestTechnique=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
