/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./DictionaryMatcher","./IntervalMatcher","./LabelMatcher","./MapMatcher","./Matcher"],(function(e,t,r,a,c,s){"use strict";async function n(e,n,i,o){switch(i.type){case"simple":case"heatmap":case"dot-density":case"pie-chart":return s.FeatureMatcher.from(e,n,i,o);case"interval":return r.IntervalMatcher.fromIntervalSchema(e,n,i,o);case"dictionary":return t.DictionaryMatcher.fromDictionaryRenderer(e,i,o);case"label":return a.LabelMatcher.fromLabelSchema(e,n,i,o);case"map":return c.MapMatcher.fromMatcherSchema(e,n,i,o);case"subtype":return u.fromSubtypes(e,n,i,o);case"cluster":return h.fromClusterSchema(e,n,i,o);default:throw new Error("Impl")}}class u extends s.FeatureMatcher{constructor(e,t){super(),this._subMatchers=e,this._subtypeField=t}static async fromSubtypes(e,t,r,a){const c=new Map,s=[];for(const u in r.renderers){const h=parseInt(u,10),i=n(e,t,r.renderers[u],a).then((e=>c.set(h,e)));s.push(i)}return await Promise.all(s),new u(c,r.subtypeField)}match(e,t){const r=e.readAttribute(this._subtypeField),a=this._subMatchers.get(r);return a?a.match(e,t):null}}class h extends s.FeatureMatcher{static async fromClusterSchema(e,t,r,a){const[c,s]=await Promise.all([n(e,t,r.feature,a),n(e,t,r.cluster,a)]);return new h(c,s)}constructor(e,t){super(),this._featureMatcher=e,this._clusterMatcher=t}match(e,t){return 1===e.readAttribute("cluster_count")?this._featureMatcher.match(e,t):this._clusterMatcher.match(e,t)}}e.ClusterMatcher=h,e.SubtypeMatcher=u,e.createMatcher=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
