/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../shaderGraph/techniques/mesh/createMeshWriter","./Matcher"],(function(e,t,r){"use strict";class s extends r.FeatureMatcher{static async fromDictionaryRenderer(e,t,r){return new s(e,t,r)}constructor(e,t,r){super(),this._storage=e,this._schema=t,this._viewParams=r,this._hashToGroup=new Map}get fieldMap(){return this._schema.fieldMap}async fetchResources(e,t){const r=t.getCursor(),s=[];for(;r.next();)s.push(this._updateMeshWriterGroup(e,r));await Promise.all(s)}match(e,t){const r=e.getAttributeHash();return this._hashToGroup.get(r)}async _updateMeshWriterGroup(e,r){const s=r.readLegacyFeatureForDisplay(),a=r.getAttributeHash();if(this._hashToGroup.has(a))return;this._hashToGroup.set(a,null);const i=await e.fetchDictionaryResourceImmediate({type:"dictionary-request",feature:s});if(!i)return;const h=await t.createMeshWriterGroupFromSchema(this._storage,e,i.meshes,this._viewParams);this._hashToGroup.set(a,h)}}e.DictionaryMatcher=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
