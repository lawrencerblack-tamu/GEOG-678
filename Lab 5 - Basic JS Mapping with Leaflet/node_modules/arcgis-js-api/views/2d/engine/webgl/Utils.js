/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../core/Error","../../../../core/Logger","../../../../symbols/cim/enums","../../../../core/RandomLCG","../../../../core/has","../../../webgl/checkWebGLError","../../../webgl/enums","../../../webgl/FramebufferObject","../../../../chunks/builtins","../../../webgl/GLObjectType","../../../webgl/getDataTypeBytes","../../../webgl/Texture","../../../webgl/TextureDescriptor","../../../webgl/VertexElementDescriptor"],(function(e,t,r,n,a,i,o,s,p,l,u,c,d,m,y){"use strict";const g=()=>r.getLogger("esri.views.2d.engine.webgl.Utils");function T(e){switch(e){case"butt":return n.CapType.BUTT;case"round":return n.CapType.ROUND;case"square":return n.CapType.SQUARE;default:return g().error(new t("mapview-invalid-type",`Cap type ${e} is not a valid option. Defaulting to round`)),n.CapType.ROUND}}function f(e){switch(e){case"miter":return n.JoinType.MITER;case"bevel":return n.JoinType.BEVEL;case"round":return n.JoinType.ROUND;default:return g().error(new t("mapview-invalid-type",`Join type ${e} is not a valid option. Defaulting to round`)),n.JoinType.ROUND}}function h(e){switch(e){case s.PixelType.UNSIGNED_BYTE:return 1;case s.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case s.PixelType.FLOAT:return 4;default:return void g().error(new t("webgl-utils",`Unable to handle type ${e}`))}}function w(e){switch(e){case s.PixelType.UNSIGNED_BYTE:return Uint8Array;case s.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case s.PixelType.FLOAT:return Float32Array;default:return void g().error(new t("webgl-utils",`Unable to handle type ${e}`))}}function b(e){const t={};for(const r in e){const n=e[r];let a=0;t[r]=n.map((e=>{const t=new y.VertexElementDescriptor(e.name,e.count,e.type,a,0,e.normalized||!1);return a+=e.count*c.getDataTypeBytes(e.type),t})),t[r]?.forEach((e=>e.stride=a))}return t}const x=e=>{const t=new Map;for(const r in e)for(const n of e[r])t.set(n.name,n.location);return t},A=e=>{const t={};for(const r in e){const n=e[r];t[r]=n?.length?n[0].stride:0}return t},D=new Map,U=(e,t)=>{if(!D.has(e)){const r=b(t),n={strides:A(r),bufferLayouts:r,attributes:x(t)};D.set(e,n)}return D.get(e)},M=e=>e.includes("data:image/svg+xml");function E(e){const t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t}const v=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4));function O(e,t,r){const n=new m.TextureDescriptor(t.width,t.height);return n.dataType=t.dataType,t.depth&&(n.depth=t.depth),t.flipped&&(n.flipped=t.flipped),t.hasMipmap&&(n.hasMipmap=t.hasMipmap),n.internalFormat=t.internalFormat,t.isImmutable&&(n.isImmutable=t.isImmutable),t.isOpaque&&(n.isOpaque=t.isOpaque),t.maxAnisotropy&&(n.maxAnisotropy=t.maxAnisotropy),n.pixelFormat=t.pixelFormat,t.preMultiplyAlpha&&(n.preMultiplyAlpha=t.preMultiplyAlpha),t.samplingMode&&(n.samplingMode=t.samplingMode),t.target&&(n.target=t.target),n.uniform=t.uniform,t.unpackAlignment&&(n.unpackAlignment=t.unpackAlignment),t.wrapMode&&(n.wrapMode=t.wrapMode),new d.Texture(e,n,r)}function N(e){return"url"in e&&"urlHash"in e?{...e,url:""}:e}e.charCodes=E,e.createAttributeLayout=b,e.createProgramDescriptor=U,e.createTexture=O,e.discardUrlIfHasUrlHash=N,e.getCapType=T,e.getJoinType=f,e.getPixelArrayCtor=w,e.getPixelBytes=h,e.isSVGImage=M,e.isValidSVG=v,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
