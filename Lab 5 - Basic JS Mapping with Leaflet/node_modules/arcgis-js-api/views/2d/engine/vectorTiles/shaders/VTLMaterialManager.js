/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../enums","./Programs"],(function(r,e){"use strict";class a{constructor(){this._programByKey=new Map}dispose(){this._programByKey.forEach((r=>r.dispose())),this._programByKey.clear()}getMaterialProgram(r,e,a){const t=e.key<<3|this._getMaterialOptionsValue(e.type,a);if(this._programByKey.has(t))return this._programByKey.get(t);const s=this._getProgramTemplate(e.type),{shaders:o}=s,{vertexShader:n,fragmentShader:g}=o(a),p=e.getShaderHeader(),c=e.getShaderMain(),h=n.replace("#pragma header",p).replace("#pragma main",c),m=r.programCache.acquire(h,g,e.getAttributeLocations());return this._programByKey.set(t,m),m}_getMaterialOptionsValue(e,a){switch(e){case r.ShaderProgramType.BACKGROUND:return(a.pattern?1:0)<<1;case r.ShaderProgramType.FILL:return(a.pattern?1:0)<<1;case r.ShaderProgramType.OUTLINE:return 0;case r.ShaderProgramType.LINE:{const r=a;return(r.sdf?1:0)<<2|(r.pattern?1:0)<<1}case r.ShaderProgramType.ICON:return(a.sdf?1:0)<<1;case r.ShaderProgramType.CIRCLE:case r.ShaderProgramType.TEXT:default:return 0}}_getProgramTemplate(a){switch(a){case r.ShaderProgramType.BACKGROUND:return e.background;case r.ShaderProgramType.CIRCLE:return e.circle;case r.ShaderProgramType.FILL:return e.fill;case r.ShaderProgramType.ICON:return e.icon;case r.ShaderProgramType.LINE:return e.line;case r.ShaderProgramType.OUTLINE:return e.outline;case r.ShaderProgramType.TEXT:return e.text;default:return null}}}return a}));
