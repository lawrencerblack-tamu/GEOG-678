/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec32","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common","./InteractionType"],(function(t,e,n,r,i,o,c){"use strict";function a(t,e,n=o.defaultConstraintOptions){if(!t.state.isLocal)return 0;const r=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;p.min=0,p.max=r,u(t,n,p);const i=f(t,e),c=p.max-i;return c>=-1e-6?0:c}function s(t,n,c=o.defaultConstraintOptions){const s=a(t,n,c);if(0===s)return!1;const u=t.pointsOfInterest.surfaceOrigin;if(!u.renderLocation)return!1;const p=f(t,n)+s,C=e.copy(y,n.eye),I=o.interactionDirectionTowardsConstraintMinimization(n,c.interactionDirection,d(n,u.renderLocation,O),l);if(!i.intersectRay(i.fromCenterAndRadius(u.renderLocation,p),r.wrap(n.eye,I),g))return!1;n.eye=g;const x=e.subtract(m,n.eye,C);n.center=e.add(g,n.center,x);const L=t.renderCoordsHelper.getAltitude(n.center),T=t.renderCoordsHelper.intersectInfiniteManifold(n.ray,L,g);return null!=T&&(n.center=T),!0}function u(t,e,n){const r=e.interactionType;if(r===c.InteractionType.NONE)return;const{min:i,max:s}=n,{interactionStartCamera:u,interactionFactor:d}=e;if(!u)return;const p=r===c.InteractionType.ZOOM||r===c.InteractionType.PAN,y=a(t,u),m=0===y?0:f(t,u);n.min=i,n.max=s;const l=.05*m;o.adjustRangeForInteraction(y,m,p,d,l,n)}function f(t,n){const r=t.pointsOfInterest.surfaceOrigin;return r.renderLocation?e.distance(n.eye,r.renderLocation):0}function d(t,n,r){return e.direction(r,t.eye,n)}const p={min:0,max:0},y=n.create(),m=n.create(),l=n.create(),O=n.create(),g=n.create();t.applyDistanceConstraint=s,t.getDistanceConstraintError=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
