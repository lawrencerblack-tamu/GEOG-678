/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../core/compilerUtils","../../../../symbols/support/ObjectSymbol3DLayerResource","./Graphics3DPathSymbolLayerConstants","./primitiveObjectSymbolUtils","./SymbolComplexity","../support/edgeUtils","../../webgl-engine/materials/DefaultMaterial"],(function(e,r,t,a,s,u,o,i){"use strict";const y=new u.EstimatedSymbolComplexity({});function l(e){if("web-style"===e.type)return y;return b(e.symbolLayers.toArray().map((r=>c(e,r))))}function b(e){let r=0,t=0,a=0,s=!1,o=0;const i=new u.SymbolComplexityMemory;for(const u of e)null!=u&&(r+=u.verticesPerFeature,t+=u.verticesPerCoordinate,a+=u.drawCallsPerFeature,i.bytesPerFeature+=u.memory.bytesPerFeature,i.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,i.resourceBytes+=u.memory.resourceBytes,i.draped.bytesPerFeature+=u.memory.bytesPerFeature,i.draped.bytesPerFeatureLabel+=u.memory.bytesPerFeatureLabel,s=s||u.estimated,++o);return s?new u.EstimatedAggregateSymbolComplexity(o,{verticesPerFeature:r,verticesPerCoordinate:t,drawCallsPerFeature:a,memory:i}):new u.AggregateSymbolComplexity(o,{verticesPerFeature:r,verticesPerCoordinate:t,drawCallsPerFeature:a,memory:i})}function m(e){const r=b(e);return r.numComplexities>0&&(r.verticesPerFeature/=r.numComplexities,r.verticesPerCoordinate/=r.numComplexities,r.drawCallsPerFeature/=r.numComplexities,r.memory.bytesPerFeature/=r.numComplexities,r.memory.bytesPerFeatureLabel/=r.numComplexities,r.memory.resourceBytes/=r.numComplexities,r.memory.draped.bytesPerFeature/=r.numComplexities,r.memory.draped.bytesPerFeatureLabel/=r.numComplexities),r}const n={};function c(e,s){const i=P(e,s),y=o.hasEdges(s)?2:0;switch(s.type){case"extrude":return new u.SymbolComplexity({verticesPerFeature:-12,verticesPerCoordinate:12,drawCallsPerFeature:y,memory:i});case"fill":if("mesh-3d"===e.type)return new u.SymbolComplexity({drawCallsPerFeature:y,memory:i});if(null!=s.outline&&s.outline.size>0)return new u.SymbolComplexity({verticesPerFeature:-12,verticesPerCoordinate:9,memory:i});case"water":return new u.SymbolComplexity({verticesPerFeature:-6,verticesPerCoordinate:3,memory:i});case"line":return new u.SymbolComplexity({verticesPerFeature:-6,verticesPerCoordinate:6,memory:i});case"object":return s.resource?.href?new u.EstimatedSymbolComplexity({verticesPerFeature:100,memory:i}):{...d(s.resource?.primitive??t.defaultPrimitive),memory:i};case"path":{let e=0,t=0;switch(s.profile){case"circle":e=a.pathNumCircleProfileSubdivisions;break;case"quad":e=4;break;default:return void r.neverReached(s.profile)}switch(s.join??"simple"){case"round":t=a.pathNumRoundJoinSubdivisions;break;case"miter":case"bevel":t=1;break;default:return}const o=2*e,y=e*t*2,l=y+o;let b=-2*y-o;switch(s.cap){case"none":break;case"butt":case"square":b+=2*(e-1);break;case"round":b+=2*(e*(a.pathNumRoundCapExtrusionSubdivisions-1)*2+e);break;default:return}return new u.SymbolComplexity({verticesPerFeature:b,verticesPerCoordinate:l,memory:i})}case"text":case"icon":return new u.SymbolComplexity({verticesPerFeature:6,memory:i});default:return}}function P(e,t){const a="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?p.EXTRUDE_EDGES:p.EXTRUDE;case"fill":return null!=t.outline&&t.outline.size>0?p.FILL_OUTLINE:p.FILL;case"water":return p.FILL;case"line":return"round"===t.join?p.LINE_ROUND:p.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return p.PATH_ROUND_CIRCLE;case"quad":return p.PATH_ROUND_QUAD;default:return void r.neverReached(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return p.PATH_MITER_CIRCLE;case"quad":return p.PATH_MITER_QUAD;default:return void r.neverReached(t.profile)}default:return}case"object":return a?p.OBJECT_POINT:p.OBJECT_POLYGON;case"icon":case"text":return a?p.ICON_POINT:p.ICON_POLYGON;default:return}}function d(e){const r=n[e];if(r)return r;const t=F(s.primitiveLodResources(e,new i.DefaultMaterial({})).levels);return n[e]=new u.SymbolComplexity({verticesPerFeature:t}),n[e]}function F(e){return e.reduce(((e,r,t)=>e+r.numVertices*(1/10**t)),0)/e.reduce(((e,r,t)=>e+1/10**t),0)}const p={ICON_POINT:{bytesPerFeature:2379.8272296852992,bytesPerFeatureLabel:852.246235,resourceBytes:0,draped:{bytesPerFeature:1868.2382921559424,bytesPerFeatureLabel:839.205415}},ICON_POLYGON:{bytesPerFeature:2957.8429876524656,bytesPerFeatureLabel:862.5307816666666,resourceBytes:0,draped:{bytesPerFeature:2579.7767085451133,bytesPerFeatureLabel:856.9298550000001}},OBJECT_POINT:{bytesPerFeature:603.543820573039,bytesPerFeatureLabel:717.4551849999999,resourceBytes:0,draped:{bytesPerFeature:603.543820573039,bytesPerFeatureLabel:717.4551849999999}},OBJECT_POLYGON:{bytesPerFeature:1111.1693389308373,bytesPerFeatureLabel:707.4535949999998,resourceBytes:0,draped:{bytesPerFeature:1111.1693389308373,bytesPerFeatureLabel:707.4535949999998}},LINE_MITER:{bytesPerFeature:3081.208408220661,bytesPerFeatureLabel:858.6749016666668,resourceBytes:0,draped:{bytesPerFeature:2682.57863388475,bytesPerFeatureLabel:844.6118016666666}},LINE_ROUND:{bytesPerFeature:3209.3236242927915,bytesPerFeatureLabel:858.1810416666667,resourceBytes:0,draped:{bytesPerFeature:2687.6256038096126,bytesPerFeatureLabel:849.578535}},PATH_MITER_CIRCLE:{bytesPerFeature:38708.74276663992,bytesPerFeatureLabel:858.70415,resourceBytes:0,draped:{bytesPerFeature:38708.74276663992,bytesPerFeatureLabel:858.70415}},PATH_ROUND_CIRCLE:{bytesPerFeature:42098.00590216518,bytesPerFeatureLabel:868.3632500000001,resourceBytes:0,draped:{bytesPerFeature:42098.00590216518,bytesPerFeatureLabel:868.3632500000001}},PATH_MITER_QUAD:{bytesPerFeature:25037.823002405767,bytesPerFeatureLabel:835.93355,resourceBytes:0,draped:{bytesPerFeature:25037.823002405767,bytesPerFeatureLabel:835.93355}},PATH_ROUND_QUAD:{bytesPerFeature:40320.254760224525,bytesPerFeatureLabel:851.66955,resourceBytes:0,draped:{bytesPerFeature:40320.254760224525,bytesPerFeatureLabel:851.66955}},FILL:{bytesPerFeature:3147.43349219103,bytesPerFeatureLabel:850.7598550000001,resourceBytes:0,draped:{bytesPerFeature:2673.7898488975106,bytesPerFeatureLabel:846.6459950000002}},FILL_OUTLINE:{bytesPerFeature:4565.099993465867,bytesPerFeatureLabel:855.334515,resourceBytes:0,draped:{bytesPerFeature:3904.46969705314,bytesPerFeatureLabel:844.7081016666667}},EXTRUDE:{bytesPerFeature:7551.2282834569505,bytesPerFeatureLabel:849.5513283333333,resourceBytes:0,draped:{bytesPerFeature:7551.2282834569505,bytesPerFeatureLabel:849.5513283333333}},EXTRUDE_EDGES:{bytesPerFeature:2959.8379634500698,bytesPerFeatureLabel:602.0969283333335,resourceBytes:0,draped:{bytesPerFeature:2959.8379634500698,bytesPerFeatureLabel:602.0969283333335}}};e.averageSymbolComplexities=m,e.defaultSymbolComplexity=l,e.defaultSymbolLayerComplexity=c,e.defaultSymbolLayerMemoryComplexity=P,e.emptySymbolComplexity=y,e.estimateNumVerticesForLods=F,e.memoryEstimators=p,e.totalSymbolComplexities=b,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
