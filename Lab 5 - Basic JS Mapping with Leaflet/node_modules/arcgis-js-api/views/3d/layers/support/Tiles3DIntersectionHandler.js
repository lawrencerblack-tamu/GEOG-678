/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../Graphic","../i3s/Intersector","../../webgl-engine/lib/Intersector","../../webgl-engine/lib/IntersectorInterfaces"],(function(e,t,i,r,s){"use strict";class n{constructor(e){this.layerUid=[],this.type=s.IntersectorType.TILES3D,this.slicePlaneEnabled=!1,this.isGround=!0,this.layerView=e,this.layerUid.push(e.layer.uid)}intersect(e,t,n,l){const o=e.results,a=e.options.store===s.StoreResults.ALL;if(e.options.filteredLayerUids.includes(this.layerView.layer.uid))return;const c=this.layerView.view._stage.renderView.componentObjectCollection;this.layerView.objects.forEach((s=>{s.visible&&s.intersectionGeometry&&c.intersect(s,n,l,e.tolerance,null,((s,c,u,d)=>{if(c>=0){if(null!=t&&!t(n,l,c))return;const s=e=>{const t=new i.Tiles3DTarget(this.layerView.layer.uid,(()=>this._createTiles3DGraphic(this.layerView.layer,{})));e.set(this.type,t,c,u)};if(this.isGround&&(null==o.ground.dist||c<o.ground.dist)&&s(o.ground),e.options.isFiltered)return;if((null==o.min.dist||c<o.min.dist)&&s(o.min),(null==o.max.dist||c>o.max.dist)&&s(o.max),a){const t=r.newIntersectorResult(e.ray);s(t),e.results.all.push(t)}}}))}))}_createTiles3DGraphic(e,i){return new t({layer:e,sourceLayer:e,attributes:i})}}e.Tiles3DIntersectionHandler=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
