/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/tslib.es6","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../ViewingMode","../core/shaderLibrary/ShaderOutput","../core/shaderLibrary/attributes/PathVertexPosition.glsl","../core/shaderLibrary/shading/Normals.glsl","../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/OrderIndependentTransparency","../lib/Program","../lib/StencilUtils","../lib/TransparencyPassType","../lib/VertexAttribute","./DefaultTechniqueConfiguration","../../../../chunks/Path.glsl","../../../webgl/renderState"],(function(e,t,r,a,o,i,s,n,l,d,c,u,p,h,b,y,m,P,v,_){"use strict";const T=new Map([[m.VertexAttribute.POSITION,0],[m.VertexAttribute.PROFILERIGHT,1],[m.VertexAttribute.PROFILEUP,2],[m.VertexAttribute.PROFILEVERTEXANDNORMAL,3],[m.VertexAttribute.FEATUREVALUE,4]]);class g extends s.PathVertexPositionPassParameters{constructor(){super(...arguments),this.ambient=a.fromValues(.2,.2,.2),this.diffuse=a.fromValues(.8,.8,.8),this.specular=a.fromValues(0,0,0),this.opacity=1,this.origin=a.create(),this.modelTransformation=null}}class f extends c.ShaderTechnique{initializeConfiguration(e,t){t.spherical=e.viewingMode===o.ViewingMode.Global,t.doublePrecisionRequiresObfuscation=e.rctx.driverTest.doublePrecisionRequiresObfuscation.result}initializeProgram(e){return new h.Program(e.rctx,f.shader.get().build(this.configuration),T)}initializePipeline(){const e=this.configuration.transparencyPassType,t=this.configuration,r=e===y.TransparencyPassType.NONE,a=e===y.TransparencyPassType.FrontFace;return _.makePipelineState({blending:t.output!==i.ShaderOutput.Color&&t.output!==i.ShaderOutput.Alpha||!t.transparent?null:r?p.blendingDefault:p.oitBlending(e),culling:t.hasSlicePlane&&!t.transparent&&t.doubleSidedMode!==n.NormalsDoubleSidedMode.None?_.frontFaceCullingParams:null,depthTest:{func:p.oitDepthTest(e)},depthWrite:r||a?_.defaultDepthWriteParams:null,colorWrite:_.defaultColorWriteParams,stencilWrite:t.hasOccludees?b.stencilWriteMaskOn:null,stencilTest:t.hasOccludees?b.stencilBaseAllZerosParams:null,polygonOffset:r||a?null:p.OITPolygonOffset})}}f.shader=new d.ReloadableShaderModule(v.Path,(()=>new Promise(((t,r)=>e(["../shaders/Path.glsl"],t,r)))));class O extends P.DefaultTechniqueConfiguration{constructor(){super(...arguments),this.output=i.ShaderOutput.Color,this.doubleSidedMode=n.NormalsDoubleSidedMode.None,this.transparencyPassType=y.TransparencyPassType.NONE,this.spherical=!1,this.receiveShadows=!1,this.receiveAmbientOcclusion=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1,this.multipassEnabled=!1,this.cullAboveGround=!1,this.doublePrecisionRequiresObfuscation=!1}}r.__decorate([u.parameter({count:i.ShaderOutput.COUNT})],O.prototype,"output",void 0),r.__decorate([u.parameter({count:n.NormalsDoubleSidedMode.COUNT})],O.prototype,"doubleSidedMode",void 0),r.__decorate([u.parameter({count:y.TransparencyPassType.COUNT})],O.prototype,"transparencyPassType",void 0),r.__decorate([u.parameter()],O.prototype,"spherical",void 0),r.__decorate([u.parameter()],O.prototype,"receiveShadows",void 0),r.__decorate([u.parameter()],O.prototype,"receiveAmbientOcclusion",void 0),r.__decorate([u.parameter()],O.prototype,"vvSize",void 0),r.__decorate([u.parameter()],O.prototype,"vvColor",void 0),r.__decorate([u.parameter()],O.prototype,"vvOpacity",void 0),r.__decorate([u.parameter()],O.prototype,"hasSlicePlane",void 0),r.__decorate([u.parameter()],O.prototype,"transparent",void 0),r.__decorate([u.parameter()],O.prototype,"hasOccludees",void 0),r.__decorate([u.parameter()],O.prototype,"multipassEnabled",void 0),r.__decorate([u.parameter()],O.prototype,"cullAboveGround",void 0),r.__decorate([u.parameter()],O.prototype,"doublePrecisionRequiresObfuscation",void 0),r.__decorate([u.parameter({constValue:!1})],O.prototype,"occlusionPass",void 0),r.__decorate([u.parameter({constValue:l.PBRMode.Disabled})],O.prototype,"pbrMode",void 0),r.__decorate([u.parameter({constValue:!0})],O.prototype,"hasVvInstancing",void 0),r.__decorate([u.parameter({constValue:!1})],O.prototype,"useCustomDTRExponentForWater",void 0),r.__decorate([u.parameter({constValue:!1})],O.prototype,"useFillLights",void 0),r.__decorate([u.parameter({constValue:!1})],O.prototype,"hasColorTexture",void 0),t.PathPassParameters=g,t.PathTechnique=f,t.PathTechniqueConfiguration=O,t.vertexAttributeLocations=T,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
