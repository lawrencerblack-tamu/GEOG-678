/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../../core/arrayUtils","../../../../../core/promiseUtils","../../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../../geometry/support/aaBoundingBox","./LodComponentData"],(function(e,t,n,o,i,r){"use strict";class s{static async create(e,o,i){const c=await Promise.allSettled(o.components.map((t=>e.controller.schedule((()=>new r.LodComponentData(e,t)),i)))),a=c.map((e=>"fulfilled"===e.status?e.value:null)).filter(t.isSome);if(n.isAborted(i)||a.length!==c.length){a.forEach((e=>e.destroy())),n.throwIfAborted(i);for(const e of c)if("rejected"===e.status)throw e.reason}return new s(o.minScreenSpaceRadius,a)}constructor(e,t){this.minScreenSpaceRadius=e,this.components=t}destroy(){this.components.forEach((e=>e.destroy()))}intersect(e,t,n,o,i,r,s){this.components.forEach((c=>c.intersect(e,t,n,o,i,r,this.boundingSphere,s)))}get boundingBox(){if(null==this._boundingBox){const e=i.empty();this.components.forEach((t=>{null!=t.boundingInfo&&(i.expandWithVec3(e,t.boundingInfo.bbMin),i.expandWithVec3(e,t.boundingInfo.bbMax))})),this._boundingBox=e}return this._boundingBox}get boundingSphere(){if(null==this._boundingSphere){const e=this.boundingBox,t=o.create();i.center(e,t),this._boundingSphere={center:t,radius:.5*i.diameter(e)}}return this._boundingSphere}get triangleCount(){return this.components.reduce(((e,t)=>e+t.triangleCount),0)}}e.LodLevel=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
