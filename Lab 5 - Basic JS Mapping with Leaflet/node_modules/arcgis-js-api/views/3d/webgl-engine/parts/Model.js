/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../../core/libs/gl-matrix-2/factories/mat4f64","../../../../chunks/sphere","../lib/ContentObjectType","../lib/GridLocalOriginFactory","../lib/ModelDirtySet","../lib/RenderGeometry","../lib/Util","../lib/WebGLLayer"],(function(e,t,o,r,n,i,s,a,c,d,l,h,y,g,b,u){"use strict";e.Model=class extends o{constructor(){super(...arguments),this.dirtySet=new y({model:this}),this._content=new Map,this._originFactory=new h.GridLocalOriginFactory(null)}getObject(e){return this._content.get(e)}add(e){const t=e.id;b.assert(!this._content.has(t),"Model/Stage already contains object to be added"),this._content.set(t,e),u.isWebGLLayer(e)&&this.dirtySet.layerAdded(e)}remove(e){return!!this._content.has(e.id)&&(this._content.delete(e.id),u.isWebGLLayer(e)&&this.dirtySet.layerRemoved(e),!0)}addMany(e){for(const t of e)t&&(b.assert(!this._content.has(t.id),"Model/Stage already contains object to be added"),this._content.set(t.id,t))}removeMany(e){for(const t of e)t&&(b.assert(this._content.has(t.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(t.id))}has(e){return this._content.has(e.id)}forEachOfType(e,t){this._content.forEach((o=>{o.type===e&&t(o)}))}getRenderGeometry(e,t){const o=new g.RenderGeometry(t,{castShadow:e.castShadow,objectShaderTransformation:e.shaderTransformation});o.transformation=e.getCombinedStaticTransformation(t,f);const{localOrigin:r}=t;return o.localOrigin=null!=r?r:this._originFactory.getOrigin(d.getCenter(o.boundingSphere)),o}updateRenderGeometryTransformation(e,t,o){if(null==e)return!1;o.transformation=e.getCombinedStaticTransformation(t,f);const r=this._originFactory.getOrigin(d.getCenter(o.boundingSphere));return o.localOrigin!==r}getStats(){const e={},t=Array.from(this._content.values());for(let o=0;o<l.ContentObjectType.COUNT;++o)e[o]=t.filter((e=>e.type===o)).length;return{contentTypes:e,dirtySet:this.dirtySet.formatDebugInfo()}}get test(){return{content:Array.from(this._content.values())}}},t.__decorate([r.property({constructOnly:!0})],e.Model.prototype,"dirtySet",void 0),e.Model=t.__decorate([a.subclass("esri.views.3d.webgl-engine.parts.Model")],e.Model);const f=c.create();Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
