/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/tslib.es6","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./RenderContext","./RenderNode"],(function(e,t,r,o,s,n,i,d,a,c){"use strict";e.ExternalRenderNode=class extends c{constructor(e){super(e),this.consumes={required:[]},this.produces="opaque-color",this.renderFunc=null,this._externalContext=new a(e.view,this)}normalizeCtorArgs(e){return{...e,consumes:{required:[e.produces]}}}initialize(){this.addHandles(r.watch((()=>this.view.ready),(e=>{e?this.setup&&(this._externalContext.rctx=this.renderingContext,this.resetWebGLState(),this.bindRenderTarget(),this.setup(this._externalContext),this.requestRender()):this.dispose&&this.dispose(this._externalContext)}),r.initial))}destroy(){this.dispose&&(this.dispose(this._externalContext),this.dispose=null)}render(){this._updateContext(),this.resetWebGLState();const e=this.bindRenderTarget();return this.renderFunc(this._externalContext),e}_updateContext(){this._externalContext.rctx=this.renderingContext,this._externalContext.camera.copyFrom(this.bindParameters.camera),this._externalContext.sunLight=this.bindParameters.lighting.legacy}},t.__decorate([o.property({constructOnly:!0})],e.ExternalRenderNode.prototype,"consumes",void 0),t.__decorate([o.property({constructOnly:!0})],e.ExternalRenderNode.prototype,"produces",void 0),t.__decorate([o.property({constructOnly:!0})],e.ExternalRenderNode.prototype,"renderFunc",void 0),t.__decorate([o.property({constructOnly:!0})],e.ExternalRenderNode.prototype,"setup",void 0),t.__decorate([o.property()],e.ExternalRenderNode.prototype,"dispose",void 0),e.ExternalRenderNode=t.__decorate([d.subclass("esri.views.3d.ExternalRenderNode")],e.ExternalRenderNode),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
