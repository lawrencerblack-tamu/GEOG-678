/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["require","./chunks/tslib.es6","./kernel","./Map","./Viewpoint","./core/Collection","./core/Error","./core/lang","./core/Loadable","./core/loadAll","./core/Logger","./core/maybe","./core/MultiOriginJSONSupport","./core/Promise","./core/promiseUtils","./core/reactiveUtils","./core/urlUtils","./core/accessorSupport/decorators/property","./core/has","./core/accessorSupport/decorators/reader","./core/accessorSupport/decorators/subclass","./core/accessorSupport/decorators/writer","./core/accessorSupport/originUtils","./core/accessorSupport/read","./geometry/Extent","./geometry/HeightModelInfo","./geometry/projection","./geometry/SpatialReference","./geometry/support/heightModelInfoUtils","./geometry/support/jsonUtils","./geometry/support/spatialReferenceUtils","./portal/Portal","./portal/PortalItem","./portal/support/jsonContext","./portal/support/portalItemUtils","./support/basemapUtils","./support/MapFloorInfo","./support/tagSymbols","./support/webSceneUtils","./views/ViewingMode","./views/support/spatialReferenceSupport","./webdoc/interfaces","./webdoc/support/resourceUtils","./webdoc/support/saveAPIKeyUtils","./webdoc/support/saveUtils","./webdoc/support/thumbnailUtils","./webscene/ApplicationProperties","./webscene/Environment","./webscene/InitialViewProperties","./webscene/Presentation","./webscene/TransportationNetwork","./webscene/Version","./webscene/support/schemaValidatorLoader"],(function(e,t,r,i,a,o,s,n,l,p,c,d,h,u,y,m,w,g,b,v,f,_,S,A,I,L,O,P,R,V,M,U,E,T,j,N,C,G,W,F,J,x,$,B,q,k,K,D,z,H,Q,X,Y){"use strict";var Z;const ee=new X.Version(1,33),te=()=>{const e=8,t=[],r=ee.major;for(let i=e;i<=ee.minor;i++)t.push(`${r}.${i}`);return t},re="Web Scene";let ie=class extends(l.LoadableMixin(u.EsriPromiseMixin(h.MultiOriginJSONMixin(i)))){constructor(e){super(e),this[Z]=!0,this._layersIdGCTimeoutId=void 0,this._updateFromPromise=null,this.applicationProperties=null,this.clippingArea=null,this.clippingEnabled=!1,this.floorInfo=null,this.heightModelInfo=void 0,this.sourceVersion=null,this.transportationNetworks=null,this.presentation=new H,this.initialViewProperties=new z,this.portalItem=null,this.resourceInfo=null,this._debouncedSaveOperations=y.debounce((async(e,t,r)=>{switch(e){case x.SaveOperationType.SAVE:return this._saveImpl(t);case x.SaveOperationType.SAVE_AS:return this._saveAsImpl(r,t)}})),this._resourceReferences={portalItem:null,paths:[]},this.authoringApp=null,this.authoringAppVersion=null,this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1}initialize(){if(this.when().catch((e=>{c.getLogger(this).error("#load()","Failed to load web scene",e)})),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(t),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this.addHandles(m.on((()=>this.allLayers),"change",(()=>this._scheduleLayersIdGC())))}destroy(){this._unscheduleLayersIdGC(),this.presentation&&this.presentation.destroy(),this.portalItem=d.destroyMaybe(this.portalItem)}writeClippingArea(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}readClippingEnabled(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}writeClippingEnabled(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}writeLayers(e,t,r,i){t[r]=this._layersToJSON(e,"operational-layers",i)}readSourceVersion(e,t){const[r,i]=t.version.split(".");return new X.Version(parseInt(r,10),parseInt(i,10))}writeSourceVersion(e,t,r){t[r]=`${ee.major}.${ee.minor}`}writeTables(e,t,r,i){const a=this._layersToJSON(e,"tables",i);a.length&&(t[r]=a)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl??null}set thumbnailUrl(e){e?this._override("thumbnailUrl",e):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=r.version}writeGround(e,t,r,i){t[r]=e?e.write({},i):{transparency:0,layers:[]}}readInitialViewProperties(e,t){const r={};return t.initialState?.environment&&(r.environment=D.fromJSON(t.initialState.environment)),r.spatialReference=t.spatialReference?P.fromJSON(t.spatialReference):P.WebMercator,r.viewingMode=t.viewingMode??"global",t.initialState?.viewpoint&&(r.viewpoint=a.fromJSON(t.initialState.viewpoint)),new z(r)}get spatialReference(){return this.initialViewProperties?.spatialReference??P.WebMercator}get viewingMode(){return this.initialViewProperties?.viewingMode??"global"}load(e){const t=this.ground;return this.addResolvingPromise(this._loadFromSource().then((()=>{t&&t!==this.ground&&t.destroy()}))),Promise.resolve(this)}loadAll(){return p.loadAll(this,(e=>{const t=this.presentation&&this.presentation.slides;e(this.ground,this.basemap,this.layers,t&&t.map((e=>e.basemap)),this.tables)}))}read(e,t){t={...t,origin:"web-scene"};const r=this._isAuthoringAppVersionSetByUser,i=this._isAuthoringAppSetByUser;if(A.readLoadable(this,e,(t=>super.read(e,t)),t),i||(this._isAuthoringAppSetByUser=!1),r||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&this.sourceVersion?.supportsVisibleElevationLayersInSlides){const t=e.baseMap.elevationLayers.map((e=>({id:e.id}))),r=this.presentation.slides,i=(e,t)=>e.visibleLayers.some((e=>e.id===t)),a=t.filter((e=>!r.some((t=>i(t,e.id)))));r.forEach((e=>{e.visibleLayers.addMany(a)}))}}_writeBasemapElevationLayers(e){const t=e.ground?.layers;!e.baseMap&&t?.length&&(e.baseMap={title:"Basemap",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=n.clone(t))}_layersToJSON(e,t,r){const i={...r,layerContainerType:t};return e.map((e=>this._verifyWritableLayer(e,r)?e.write({},i):null)).filter((e=>!!e)).toArray()}_verifyWritableLayer(e,t){return!!e.persistenceEnabled&&("write"in e||(t?.messages&&t.messages.push(new s("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in web scenes`,{layer:e})),!1))}write(e,t){if("loaded"!==this.loadStatus){const e=new s("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw c.getLogger(this).error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),e}this._runLayersIdGC();const r=!t?.messages;t={messages:[],...t,origin:"web-scene"};const i=super.write(e,t);if(r){const e=t.messages?.filter((e=>"web-document-write:property-required"===e.name))??[];if(e.length){const t=new s("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:e});throw c.getLogger(this).error("#toJSON()","One or more properties that are required in the webscene JSON are missing",e),t}}return this._writeBasemapElevationLayers(i),i}async save(e){return this._debouncedSaveOperations(x.SaveOperationType.SAVE,e)}async _saveImpl(e){if(!this.portalItem)throw new s("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene");if(B.validateSaveAPIKey(this.portalItem),this.portalItem?.type!==re)throw new s("webscene:portal-item-wrong-type",`Portal item needs to have type "${re}"`);const t=this._updateFromPromise;await this._ensureLoadBeforeSave();const r=this._enableVerifyItemRelativeUrls(T.createForItemWrite(this.portalItem,"web-scene",!0)),i=this.write({},r);return await Promise.all(r.resources.pendingOperations),await this._verifySave(i,r,e),this._updateTypeKeywords(this.portalItem),await $.updateItemWithResources(this.portalItem,i,this._resourceReferences,r),S.updateOrigins(r),t&&await t,await this._saveThumbnail(),this.portalItem}async saveAs(e,t){return this._debouncedSaveOperations(x.SaveOperationType.SAVE_AS,t,e)}async _saveAsImpl(e,t){let r=E.from(e);if(!r)throw new s("webscene:portal-item-required","saveAs requires a portal item to save to");B.validateSaveAPIKey(r),r.id&&(r=r.clone(),r.id=null);const i=r.portal||U.getDefault();await this._ensureLoadBeforeSave(),r.type=re,r.portal=i;const a=this._enableVerifyItemRelativeUrls(T.createForItemWrite(r,"web-scene",!0)),o=this.write({},a);await Promise.all(a.resources.pendingOperations),await this._verifySaveAs(o,a,t);const n=this.thumbnailUrl,l=!this._isOverridden("thumbnailUrl");if(this._updateTypeKeywords(r),await i.signIn(),!i.user)throw new s("webscene:user-not-signed-in","saveAs requires a user to be signed in to the portal");return await i.user.addItem({item:r,folder:t?.folder,data:o}),await $.saveResources(this._resourceReferences,a),this.portalItem=r,h.MultiOriginJSONSupport.prototype.read.call(this,{version:o.version,authoringApp:o.authoringApp,authoringAppVersion:o.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:r.itemUrl?w.urlToObject(r.itemUrl):void 0}),S.updateOrigins(a),n&&(this.thumbnailUrl=l?w.addQueryParameter(n,"w","8192"):n),a.portalItem=r,await this._saveThumbnail(),r}async _saveThumbnail(){this._isOverridden("thumbnailUrl")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl})),this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}async _verifySave(e,t,r,i=!1){if(!M.isEarth(this.spatialReference))throw new s("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently.");const{ignoreUnsupported:a,requiredPropertyChecksDisabled:o,strictSchemaValidationEnabled:n}=r||{};q.evaluateWriteErrors(t,{errorName:"webscene:save"},{ignoreUnsupported:a,supplementalUnsupportedErrors:["scenemodification:unsupported"],requiredPropertyChecksDisabled:o});const l=Y.getLoader();if(n&&l){const t=(await l()).validate(e);if(!t.length)return;const r=`webscene did not validate:\n${t.join("\n")}`;c.getLogger(this).error(`${i?"saveAs":"save"}(): ${r}`);const a=t.map((e=>new s("webscene:schema-validation",e)));throw W.createSchemaValidationError(a)}}_verifySaveAs(e,t,r){return this.canNotSaveAs(t)?Promise.reject(W.createCopyError()):this._verifySave(e,t,r,!0)}verifySaveAs(e){const t=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),r=this.write({},t);return this._verifySaveAs(r,t,e)}canNotSaveAs(e){return e||(e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},e)),(e.verifyItemRelativeUrls?.writtenUrls?.length??0)>0}async updateFrom(e,t={}){const r=this._updateFrom(e,t);this._updateFromPromise=r,await r;this._updateFromPromise===r&&(this._updateFromPromise=null)}async _updateFrom(e,t={}){if(await e.whenReady(),!t.environmentExcluded&&e.environment&&(this.initialViewProperties.environment=D.prototype.clone.apply(e.environment)),!t.viewpointExcluded&&e.viewpoint&&(this.initialViewProperties.viewpoint=e.viewpoint.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),this.initialViewProperties.viewingMode=e.viewingMode,null!=e.clippingArea?e.clippingArea!==this.clippingArea&&(this.clippingArea=e.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,e.heightModelInfo&&(this.heightModelInfo=e.heightModelInfo.clone()),e.map===this)for(const r of e.allLayerViews){const e="visible";e in r&&e in r.layer&&r._isOverridden(e)&&(r.layer[e]=r[e])}(!1===t.thumbnailExcluded||null==t.thumbnailExcluded&&!t.viewpointExcluded)&&await this._updateFromThumbnail(e,t.thumbnailSize??void 0)}async _updateFromThumbnail(e,t){const r=k.getOptimalThumbnailSize(e,t),i=await e.takeScreenshot({format:"jpg",width:r.width,height:r.height,disableDecorations:!0});this.thumbnailUrl=i.dataUrl}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):this.portalItem?.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}_readAndLoadFromJSON(e,t){const r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}_extractOperationalLayers(e){const t=[];if(!this.sourceVersion?.supportsGround&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers))for(const a of e.baseMap.elevationLayers)t.push(a);const r=[],i=e=>(e.layers&&(e.layers=e.layers.filter(i)),"ArcGISTiledElevationServiceLayer"!==e.layerType||(this.sourceVersion?.supportsGround||r.push(e),!1));return{operationalLayers:e.operationalLayers?e.operationalLayers.filter(i):[],operationalElevationLayers:r,basemapElevationLayers:t}}async _loadFromJSON(t,r){const i=new o;await this._validateSpatialReference(),await this._validateHeightModelInfo();const{populateOperationalLayers:a}=await new Promise(((t,r)=>e(["./layers/support/layersCreator"],t,r))),{operationalLayers:s,operationalElevationLayers:n,basemapElevationLayers:l}=this._extractOperationalLayers(t),p=[],c={context:{...r,layerContainerType:"operational-layers"}};if(this.portalItem&&(c.context.portal=this.portalItem.portal||U.getDefault()),l.length>0){const e={...c,context:{...c.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",p.push(a(this.ground.layers,l,e))}if(n.length>0){const e={...c,context:{...c.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",p.push(a(i,n,e))}s&&s.length>0&&p.push(a(this.layers,s,c)),t.tables?.length&&p.push(a(this.tables,t.tables,{...c,context:{...c.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"})),await Promise.allSettled(p),await this._loadObjectsWithLayers(),this.ground.layers.addMany(i)}async _ensureLoadBeforeSave(){await this.load(),await this._loadObjectsWithLayers();const e=[],t=[...this.allLayers.items];for(const{basemap:r}of this.presentation.slides.items)r&&(t.push(...r.baseLayers.items),t.push(...r.referenceLayers.items));for(const r of t)if("beforeSave"in r&&"function"==typeof r.beforeSave){const t=r.beforeSave();t&&e.push(t)}await Promise.allSettled(e)}async _loadObjectsWithLayers(){const e=[];this.ground&&e.push(this.ground.load()),this.basemap&&e.push(this.basemap.load()),this.presentation.slides.forEach((t=>{t.basemap&&e.push(t.basemap.load())})),await Promise.allSettled(e)}async _loadFromItem(e){if(await e.load().catch((e=>{throw new s("webscene:load-portal-item","Failed to load portal item",{error:e})})),"Web Scene"!==e.type)throw new s("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:e.type});const t=await e.fetchData();this.resourceInfo=t;const r={origin:"web-scene",url:w.urlToObject(e.itemUrl),portal:e.portal||U.getDefault(),portalItem:e,readResourcePaths:[]};await this._readAndLoadFromJSON(t,r),this._resourceReferences={portalItem:e,paths:r.readResourcePaths??[]}}_validateSpatialReference(){const e=this.initialViewProperties,t=this._sceneSpatialReference;let r;if("local"!==e.viewingMode){if(!J.isSpatialReferenceSupported(t,F.ViewingMode.Global))return Promise.reject(new s("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:t,viewingMode:e.viewingMode}));r=e=>!e||O.canProjectWithoutEngine(e,t)}else{if(!J.isSpatialReferenceSupported(t,F.ViewingMode.Local))return Promise.reject(new s("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:t,viewingMode:e.viewingMode}));r=e=>!e||e.equals(t)}const i=e=>e?.camera?.position.spatialReference??e?.targetGeometry?.spatialReference,a=e.viewpoint,o=i(a);if(o&&!r(o))return Promise.reject(new s("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:o,sceneSpatialReference:t,viewingMode:e.viewingMode}));const n=this.presentation.slides.find((e=>!r(i(e.viewpoint))));if(n){const r=i(n.viewpoint);return Promise.reject(new s("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:r,sceneSpatialReference:t,viewingMode:e.viewingMode}))}return Promise.resolve()}_validateHeightModelInfo(){const e=this._sceneSpatialReference,t=R.validateWebSceneError(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}_validateJSON(e){const t=X.Version.parse(e.version||"","webscene");return ee.validate(t),e.version=`${t.major}.${t.minor}`,1===t.major&&t.minor<=2&&(e.spatialReference=P.WebMercator.toJSON()),e}_updateTypeKeywords(e){j.toggleTypeKeyword(e,j.typeKeyword.LOCAL_SCENE,"local"===this.initialViewProperties.viewingMode),j.toggleTypeKeyword(e,j.typeKeyword.DEVELOPER_BASEMAP,N.hasDeveloperBasemapLayer(this.basemap)||this.presentation.slides.some((({basemap:e})=>!!e&&N.hasDeveloperBasemapLayer(e)))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}get _sceneSpatialReference(){return this.initialViewProperties.spatialReference||P.WebMercator}get _verifyItemRelativeRootPath(){return this.portalItem?.itemUrl?w.urlToObject(this.portalItem.itemUrl).path:null}_enableVerifyItemRelativeUrls(e){const t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}_unscheduleLayersIdGC(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}_scheduleLayersIdGC(){this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((()=>{this._layersIdGCTimeoutId=0,this._runLayersIdGC()}),3e3)}_runLayersIdGC(){this._unscheduleLayersIdGC();const e=this.applicationProperties?.viewing?.search,t=e=>this.allLayers.some((t=>t.id===e&&t.persistenceEnabled));e&&e.layers&&(e.layers=e.layers.filter((e=>t(e.id))));const r=this.presentation&&this.presentation.slides;r&&r.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>t(e.id))))}))}static fromJSON(e){if(!e)throw new s("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};Z=G.WebSceneTag,ie.version=`${ee.major}.${ee.minor}`,t.__decorate([g.property({type:K,json:{write:!0}})],ie.prototype,"applicationProperties",void 0),t.__decorate([g.property({type:I,json:{read:{source:"clippingArea.geometry",reader:V.fromJSON},write:{target:"clippingArea.geometry"}}})],ie.prototype,"clippingArea",void 0),t.__decorate([_.writer("clippingArea")],ie.prototype,"writeClippingArea",null),t.__decorate([g.property({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],ie.prototype,"clippingEnabled",void 0),t.__decorate([v.reader("clippingEnabled",["clippingArea"])],ie.prototype,"readClippingEnabled",null),t.__decorate([_.writer("clippingEnabled")],ie.prototype,"writeClippingEnabled",null),t.__decorate([g.property({type:C,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],ie.prototype,"floorInfo",void 0),t.__decorate([g.property({type:L,json:{write:!0}})],ie.prototype,"heightModelInfo",void 0),t.__decorate([g.property({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],ie.prototype,"layers",void 0),t.__decorate([_.writer("layers")],ie.prototype,"writeLayers",null),t.__decorate([g.property({readOnly:!0,type:X.Version,json:{type:te(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:()=>({enabled:!0,allowNull:!0,ignoreOrigin:!0})}}})],ie.prototype,"sourceVersion",void 0),t.__decorate([v.reader("sourceVersion",["version"])],ie.prototype,"readSourceVersion",null),t.__decorate([_.writer("sourceVersion")],ie.prototype,"writeSourceVersion",null),t.__decorate([g.property({json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],ie.prototype,"tables",void 0),t.__decorate([_.writer("tables")],ie.prototype,"writeTables",null),t.__decorate([g.property()],ie.prototype,"thumbnailUrl",null),t.__decorate([g.property({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],ie.prototype,"authoringApp",null),t.__decorate([_.writer("authoringApp")],ie.prototype,"writeAuthoringApp",null),t.__decorate([g.property({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],ie.prototype,"authoringAppVersion",null),t.__decorate([_.writer("authoringAppVersion")],ie.prototype,"writeAuthoringAppVersion",null),t.__decorate([g.property({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],ie.prototype,"ground",void 0),t.__decorate([_.writer("ground")],ie.prototype,"writeGround",null),t.__decorate([g.property({type:o.ofType(Q),json:{write:!0}})],ie.prototype,"transportationNetworks",void 0),t.__decorate([g.property({type:H,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:(e,t,r,i)=>{if(e.slides&&e.slides.length>0){const r={...i,isPresentation:!0};t.presentation=e.write({},r)}}}}})],ie.prototype,"presentation",void 0),t.__decorate([g.property({type:z,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,ignoreOrigin:!0},default:()=>new z({viewingMode:"global",spatialReference:P.WebMercator})}})],ie.prototype,"initialViewProperties",void 0),t.__decorate([v.reader("initialViewProperties",["initialState.environment","initialState.viewpoint","spatialReference","viewingMode"])],ie.prototype,"readInitialViewProperties",null),t.__decorate([g.property({type:P,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],ie.prototype,"spatialReference",null),t.__decorate([g.property({type:["local","global"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],ie.prototype,"viewingMode",null),t.__decorate([g.property({type:E})],ie.prototype,"portalItem",void 0),t.__decorate([g.property()],ie.prototype,"resourceInfo",void 0),ie=t.__decorate([f.subclass("esri.WebScene")],ie);return ie}));
