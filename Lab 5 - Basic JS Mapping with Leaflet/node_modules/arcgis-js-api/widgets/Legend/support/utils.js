/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["require","exports","../../../symbols","../../../core/timeUtils","../../../layers/support/fieldUtils","../../../renderers/support/numberUtils","../../../smartMapping/support/utils","../../../symbols/SimpleLineSymbol"],(function(e,t,A,n,i,a,l,o){"use strict";const r="<",s=">";function u(e,t,A,n){let i="";0===t?i=`${r} `:t===A&&(i=`${s} `);return i+(n?l.formatAnyDate(e,n):a.format(e))}const p=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function d(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const A=t.visualVariables.find((e=>"color"===e.type));if(!A)return null;let n=null,i=null;if(A.stops){if(1===A.stops.length)return A.stops[0].color;n=A.stops[0].value,i=A.stops[A.stops.length-1].value}const a=null!=n&&null!=i?n+(i-n)/2:0,{getColor:l}=await new Promise(((t,A)=>e(["../../../renderers/visualVariables/support/visualVariableUtils"],t,A)));return l(A,a)??null}async function c(e,t){const A=e.trailCap,n=e.trailWidth||1,i=t||await d(e)||e.color;return new o({cap:A,color:i,width:n})}function f(e){return null!=e&&"object"==typeof e&&"min"in e&&"max"in e}function m(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{const A=e.featureReduction.fields.find((({name:e})=>e.toLowerCase()===t.field.toLowerCase()));return A&&"getField"in e?e.getField(A.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}function g(e,t){const A="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(A?.length&&t)return A.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))?.format?.dateFormat}function w(e,t,A){const a=m(e,t);if(!a||!l.isAnyDateField(a)&&!i.isTimeOnlyField(a))return null;let o=g(e,a.name);if(!o&&"date"===a.type){let e=0,A=0;t.stops?(e=t.stops?.at(0)?.value??e,A=t.stops?.at(-1)?.value??A):"minDataValue"in t&&"maxDataValue"in t&&(e=t.minDataValue??e,A=t.maxDataValue??A),o=A-e>2*n.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:a.type,format:o,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:A,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}t.createStopLabel=u,t.getDateFormatOptions=w,t.getMedianColor=d,t.getSymbolForFlowRenderer=c,t.isRasterBandStatistics=f,t.rgbImgSource=p,t.specialCharsGreaterThan=s,t.specialCharsLessThan=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
