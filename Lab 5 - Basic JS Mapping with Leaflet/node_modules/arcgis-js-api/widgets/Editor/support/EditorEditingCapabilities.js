/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../layers/support/EditingCapabilities","../../../views/layers/support/editableLayerViews","../../Feature/support/featureUtils"],(function(e,t,r,a,l,n,s,o,i){"use strict";let p=class extends s{constructor(e){super(e),this.layerInfo=null,this.layerView=null}get attachments(){const e=this.defaults.attachments.enabled,t=this.layerInfo;return{enabled:e&&!1!==t?.allowAttachments&&!1!==t?.enabled}}get create(){const{attachments:e,defaults:t,layerInfo:r,layer:a,layerView:l}=this,n=t.create,s=!1!==r?.enabled&&!1!==r?.addEnabled,o=n.enabled&&s;return{attributes:o&&n.attributes,enabled:o,geometry:o&&n.geometry&&d(a,l),attachments:{enabled:e.enabled&&o&&!1!==r?.attachmentsOnCreateEnabled},reliesOnOwnerAdminPrivileges:n.reliesOnOwnerAdminPrivileges}}get defaults(){return new s({layer:this.layer})}get delete(){const{defaults:e,layerInfo:t}=this,r=e.delete,a=!1!==t?.enabled&&!1!==t?.deleteEnabled;return{enabled:r.enabled&&a,reliesOnOwnerAdminPrivileges:r.reliesOnOwnerAdminPrivileges}}get formTemplate(){const{layer:e,layerInfo:t}=this;return t?.formTemplate?t.formTemplate:e&&"formTemplate"in e?e.formTemplate:null}get relationship(){const{layer:e}=this,t=!(!i.isRelatableFeatureSupportedLayer(e)||!e.relationships?.length),r=!!this.formTemplate?.elements?.some((e=>"relationship"===e.type));return{enabled:t&&r}}get update(){const{attachments:e,defaults:t,layerInfo:r,layer:a,layerView:l}=this,n=t.update,s=!1!==r?.enabled&&!1!==r?.updateEnabled,o=n.enabled&&s,i=o&&n.attributes&&!1!==r?.attributeUpdatesEnabled,p=o&&n.geometry&&!1!==r?.geometryUpdatesEnabled&&d(a,l),c=e.enabled&&!1!==r?.attachmentsOnUpdateEnabled;return{attributes:i,enabled:o,geometry:p,attachments:{enabled:c,create:c&&n.attachments.create,update:c&&n.attachments.update},reliesOnOwnerAdminPrivileges:n.reliesOnOwnerAdminPrivileges}}};function d(e,t){return"scene"!==e.type||null!=t&&"type"in t&&"scene-layer-3d"===t.type&&o.isGeometryEditableSceneLayer(e,t)}e.__decorate([t.property()],p.prototype,"attachments",null),e.__decorate([t.property()],p.prototype,"create",null),e.__decorate([t.property()],p.prototype,"defaults",null),e.__decorate([t.property()],p.prototype,"delete",null),e.__decorate([t.property()],p.prototype,"formTemplate",null),e.__decorate([t.property()],p.prototype,"layerInfo",void 0),e.__decorate([t.property()],p.prototype,"layerView",void 0),e.__decorate([t.property()],p.prototype,"relationship",null),e.__decorate([t.property()],p.prototype,"update",null),p=e.__decorate([n.subclass("esri.widgets.Editor.support.EditorEditingCapabilities")],p);return p}));
