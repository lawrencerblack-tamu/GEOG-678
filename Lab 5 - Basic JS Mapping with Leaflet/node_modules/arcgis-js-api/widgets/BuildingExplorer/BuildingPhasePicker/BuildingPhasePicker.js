/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../Widget","../../support/globalCss","../../support/widgetUtils","../../support/jsxFactory"],(function(e,s,t,r,i,o,a,n,h,c,l){"use strict";const u={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"},p="esri-building-phase-picker",d={container:`${p}`,phasesContainer:`${p}__phases-container`,phase:`${p}__phase`,phaseActive:`${p}__phase--active`,phaseCurrent:`${p}__phase--current`,divider:`${p}__divider`,dividerActive:`${p}__divider--active`,arrowLeft:`${p}__arrow-left`,arrowRight:`${p}__arrow-right`};let _=class extends n{constructor(e,s){super(e,s),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=e=>{const{vm:s}=this;switch(e.key){case"ArrowDown":case"ArrowLeft":e.stopPropagation(),e.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":e.stopPropagation(),e.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=e=>{this._phasesContainer=e,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const e=this._phasesContainer;if(this.destroyed||null==e)return;const s=e.querySelector(`.${d.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const t=e.offsetWidth,r=s.offsetLeft,i=s.offsetWidth;e.scrollLeft=-t/2+r-i/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}initialize(){this.addHandles(s.watch((()=>[this._currentPhase,this._phasesContainer,this.container]),(()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)}),s.initial))}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:e}=this;return e.enabled?e.value:null}render(){if(this._phases.length<2)return l.tsx("div",{key:"no-phases"});const{vm:e,container:s,messages:t}=this,{previousPhase:r,nextPhase:i}=t??u,o=c.isRTL(s);return l.tsx("div",{class:this.classes(h.globalCss.widget,d.container),key:this,onkeydown:this._onKeyDown},l.tsx("button",{"aria-label":r,class:o?d.arrowRight:d.arrowLeft,disabled:!e.hasPrevious,onclick:this._onArrowLeftClick,title:r,type:"button"}),l.tsx("div",{afterCreate:this._onPhasesContainerAfterCreate,class:d.phasesContainer},this._renderPhaseButtons()),l.tsx("button",{"aria-label":i,class:o?d.arrowLeft:d.arrowRight,disabled:!e.hasNext,onclick:this._onArrowRightClick,title:i,type:"button"}))}_renderPhaseButtons(){const e=this._phases,s=this._currentPhase,t=[];for(let r=0;r<e.length;++r){const i=e[r],o={phase:i,active:null!=s&&i<=s,current:null!=s&&i===s};r>0&&t.push(this._renderDivider(o)),t.push(this._renderPhaseButton(o))}return t}_renderPhaseButton({phase:e,active:s,current:t}){const{vm:r}=this,i=r.getValueLabel(e);return l.tsx("button",{"aria-label":i,class:this.classes(d.phase,{[d.phaseActive]:s,[d.phaseCurrent]:t}),key:`phase-${e}`,onclick:()=>r.select(e),title:i,type:"button"},e)}_renderDivider({phase:e,active:s}){return l.tsx("div",{class:this.classes(d.divider,{[d.dividerActive]:s}),key:`phase-divider-${e}`})}};e.__decorate([t.property({nonNullable:!0})],_.prototype,"vm",void 0),e.__decorate([t.property()],_.prototype,"messages",void 0),e.__decorate([t.property()],_.prototype,"_phases",null),e.__decorate([t.property()],_.prototype,"_currentPhase",null),e.__decorate([t.property()],_.prototype,"_phasesContainer",void 0),_=e.__decorate([a.subclass("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],_);return _}));
