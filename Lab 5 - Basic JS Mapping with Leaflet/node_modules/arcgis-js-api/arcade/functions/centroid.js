/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../core/mathUtils","../../geometry/Point","../../geometry/support/intersectsBase"],(function(t,n,e,r){"use strict";function o(t,n,e){return Math.sqrt((t[0]-n[0])**2+(t[1]-n[1])**2+(void 0!==t[2]&&void 0!==n[2]?(t[2]*e-n[2]*e)**2:0))}function s(t,n,e){return Math.sqrt((t[0]-n[0])**2+(t[1]-n[1])**2+(void 0!==t[2]&&void 0!==n[2]?(t[2]*e-n[2]*e)**2:0))}const i=[];for(const b of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){const t=b[0];for(let n=1;n<b.length;n++)i[b[n]]=t}const c=[];function a(t){return t.vcsWkid&&void 0!==i[t.vcsWkid]?c[i[t.vcsWkid]]:t.latestVcsWkid&&void 0!==i[t.latestVcsWkid]?c[i[t.latestVcsWkid]]:1}function l(t,n,e){const r={x:0,y:0};n&&(r.z=0),e&&(r.m=0);let o=0,s=t[0];for(let i=0;i<t.length;i++){const c=t[i];if(!1===y(c,s)){const t=h(s,c,n),i=u(s,c,n,e);i.x*=t,i.y*=t,r.x+=i.x,r.y+=i.y,n&&(i.z*=t,r.z+=i.z),e&&(i.m*=t,r.m+=i.m),o+=t,s=c}}return o>0?(r.x/=o,r.y/=o,n&&(r.z/=o),e&&(r.m/=o)):(r.x=t[0][0],r.y=t[0][1],n&&(r.z=t[0][2]),e&&n?r.m=t[0][3]:e&&(r.m=t[0][2])),r}function u(t,n,e,r){const o={x:(t[0]+n[0])/2,y:(t[1]+n[1])/2};return e&&(o.z=(t[2]+n[2])/2),e&&r?o.m=(t[3]+n[3])/2:r&&(o.m=(t[2]+n[2])/2),o}function f(t,n){if(t.length<=1)return 0;let e=0;for(let r=1;r<t.length;r++)e+=h(t[r-1],t[r],n);return e}function h(t,n,e){const r=n[0]-t[0],o=n[1]-t[1];if(e){const t=n[2]-n[2];return Math.sqrt(r*r+o*o+t*t)}return Math.sqrt(r*r+o*o)}function g(t,n,e){const r=n[0]-t[0],o=n[1]-t[1];if(e){const t=n[2]-n[2];return r*r+o*o+t*t}return r*r+o*o}function y(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function m(t){const n={x:0,y:0,spatialReference:t.spatialReference.toJSON()},r={x:0,y:0,spatialReference:t.spatialReference.toJSON()};let o=0,s=0;for(let e=0;e<t.paths.length;e++){if(0===t.paths[e].length)continue;const i=f(t.paths[e],!0===t.hasZ);if(0===i){const r=l(t.paths[e],!0===t.hasZ,!0===t.hasM);n.x+=r.x,n.y+=r.y,!0===t.hasZ&&(n.z+=r.z),!0===t.hasM&&(n.m+=r.m),++o}else{const n=l(t.paths[e],!0===t.hasZ,!0===t.hasM);r.x+=n.x*i,r.y+=n.y*i,!0===t.hasZ&&(r.z+=n.z*i),!0===t.hasM&&(r.m+=n.m*i),s+=i}}return s>0?(r.x/=s,r.y/=s,!0===t.hasZ&&(r.z/=s),!0===t.hasM&&(r.m/=s),new e(r)):o>0?(n.x/=o,n.y/=o,!0===t.hasZ&&(r.z/=o),!0===t.hasM&&(n.m/=o),new e(n)):null}function x(t){if(0===t.points.length)return null;let n=0,r=0,o=0,s=0;for(let e=0;e<t.points.length;e++){const i=t.getPoint(e);!0===i.hasZ&&(o+=i.z),!0===i.hasM&&(s+=i.m),n+=i.x,r+=i.y,s+=i.m}const i={x:n/t.points.length,y:r/t.points.length,spatialReference:null};return i.spatialReference=t.spatialReference.toJSON(),!0===t.hasZ&&(i.z=o/t.points.length),!0===t.hasM&&(i.m=s/t.points.length),new e(i)}function M(t,n){return t.x*n.x+t.y*n.y}function d(t,n){return t.x*n.y-n.x*t.y}function p(t,n,e=0){for(;t<e;)t+=n;const r=e+n;for(;t>=r;)t-=n;return t}function z(t,n){return Math.atan2(n.y-t.y,n.x-t.x)}function P(t,n){return p(z(t,n),2*Math.PI)*(180/Math.PI)}function S(t,n){return p(Math.PI/2-z(t,n),2*Math.PI)*(180/Math.PI)}function v(t,n,e){const r={x:t.x-n.x,y:t.y-n.y},o={x:e.x-n.x,y:e.y-n.y};return Math.atan2(d(r,o),M(r,o))}function I(t,e,r){return n.rad2deg(p(v(t,e,r),2*Math.PI))}function R(t,e,r){return n.rad2deg(p(-1*v(t,e,r),2*Math.PI))}c[9002]=.3048,c[9003]=.3048006096012192,c[9095]=.3048007491;const Z=[0,0];function W(t){for(let n=0;n<t.length;n++){const e=t[n];for(let s=0;s<e.length-1;s++){const o=e[s],i=e[s+1];for(let e=n+1;e<t.length;e++)for(let n=0;n<t[e].length-1;n++){const s=t[e][n],c=t[e][n+1];if(r.segmentIntersects(o,i,s,c,Z)&&!(Z[0]===o[0]&&Z[1]===o[1]||Z[0]===s[0]&&Z[1]===s[1]||Z[0]===i[0]&&Z[1]===i[1]||Z[0]===c[0]&&Z[1]===c[1]))return!0}}const o=e.length;if(!(o<3))for(let t=0;t<=o-2;t++){const n=e[t],s=e[t+1];for(let i=t+2;i<=o-2;i++){const t=e[i],o=e[i+1];if(r.segmentIntersects(n,s,t,o,Z)&&!(Z[0]===n[0]&&Z[1]===n[1]||Z[0]===t[0]&&Z[1]===t[1]||Z[0]===s[0]&&Z[1]===s[1]||Z[0]===o[0]&&Z[1]===o[1]))return!0}}}return!1}function k(t,n,e){return Math.max(n,Math.min(e,t))}function q(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function w(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function L(t,n,e){const r=[e[0]-n[0],e[1]-n[1],e[2]-n[2]],o=k(q(r,[t[0]-n[0],t[1]-n[1],t[2]-n[2]])/w(r),0,1);return[n[0]+(e[0]-n[0])*o,n[1]+(e[1]-n[1])*o,n[2]+(e[2]-n[2])*o]}function O(t,n,e){let r=0;const o=e[0]-n[0],s=e[1]-n[1],i=o*o+s*s;if(0===i)r=.5;else{r=((t[0]-n[0])*o+(t[1]-n[1])*s)/i,r<0?r=0:r>1&&(r=1)}return r<=.5?[n[0]+(e[0]-n[0])*r,n[1]+(e[1]-n[1])*r]:[e[0]-(e[0]-n[0])*(1-r),e[1]-(e[1]-n[1])*(1-r)]}t.angle2D=P,t.angleBetween2D=I,t.angleBetweenRad=v,t.angleRad=z,t.bearing2D=S,t.bearingBetween2D=R,t.centroidMultiPoint=x,t.centroidPolyline=m,t.closestPointOnLineSegment=O,t.closestPointOnLineSegmentWithZ=L,t.getMetersPerVerticalUnitForSR=a,t.pathsSelfIntersecting=W,t.segmentLength=h,t.segmentLength3d=o,t.segmentLength3dSqr=s,t.segmentLengthSqr=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
