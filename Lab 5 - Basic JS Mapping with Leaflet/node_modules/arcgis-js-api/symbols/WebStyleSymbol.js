/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../core/Logger","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","../portal/Portal","../chunks/persistableUrlUtils","./Symbol","./support/Thumbnail"],(function(e,t,r,o,l,s,a,n,c,p,i,y,u){"use strict";var h;let m=h=class extends y{constructor(e){super(e),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=null!=this.portal?this.portal:p.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t?.portal,super.read(e,t)}clone(){return new h({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol("webRef",e)}fetchCIMSymbol(e){return this._fetchSymbol("cimRef",e)}async _fetchSymbol(t,l){const s=null!=l?l.cache:null,a=s?this._fetchCacheKey:null;if(null!=s){const e=a&&s.get(a);if(e)return e.clone()}const{resolveWebStyleSymbol:n}=await new Promise(((t,r)=>e(["./support/webStyleSymbolUtils"],t,r)));o.throwIfAborted(l);const c=n(this,{portal:this.portal},t,l);c.catch((e=>{r.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",e)}));const p=await c;return"webRef"===t&&"point-3d"===p.type||"cimRef"===t&&"cim"===p.type?(null!=s&&s.set(a,p.clone()),p):null}};t.__decorate([l.property({json:{write:!1}})],m.prototype,"color",void 0),t.__decorate([l.property({type:String,json:{write:!0}})],m.prototype,"styleName",void 0),t.__decorate([l.property({type:p,json:{write:!1}})],m.prototype,"portal",void 0),t.__decorate([l.property({type:String,json:{read:i.read,write:i.write}})],m.prototype,"styleUrl",void 0),t.__decorate([l.property({type:u.Thumbnail,json:{read:!1}})],m.prototype,"thumbnail",void 0),t.__decorate([l.property({type:String,json:{write:!0}})],m.prototype,"name",void 0),t.__decorate([n.enumeration({styleSymbolReference:"web-style"},{readOnly:!0})],m.prototype,"type",void 0),t.__decorate([l.property()],m.prototype,"_fetchCacheKey",null),m=h=t.__decorate([c.subclass("esri.symbols.WebStyleSymbol")],m);return m}));
