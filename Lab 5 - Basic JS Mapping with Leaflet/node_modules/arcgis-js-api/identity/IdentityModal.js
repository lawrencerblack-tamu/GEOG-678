/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../intl","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../widgets/Widget","../chunks/componentsUtils","../widgets/support/widgetUtils","../widgets/support/decorators/messageBundle","../widgets/support/jsxFactory","../support/themeUtils","../intl/substitute"],(function(e,t,s,o,i,n,r,a,l,c,u,p,d,h,m){"use strict";const _="esri-identity-modal",y={base:_,info:`${_}__info`,notice:`${_}__notice`},g="ArcGIS Online";let b=class extends l{constructor(e,t){super(e,t),this.container=document.createElement("div"),this.error=null,this.oAuthPrompt=!1,this.open=!1,this.signingIn=!1,this.server=null,this.resource=null,this._usernameInputNode=null,this._passwordInputNode=null,document.body.appendChild(this.container)}loadDependencies(){return c.loadCalciteComponents({button:()=>new Promise(((t,s)=>e(["../chunks/calcite-button"],t,s))),input:()=>new Promise(((t,s)=>e(["../chunks/calcite-input"],t,s))),label:()=>new Promise(((t,s)=>e(["../chunks/calcite-label"],t,s))),modal:()=>new Promise(((t,s)=>e(["../chunks/calcite-modal"],t,s))),notice:()=>new Promise(((t,s)=>e(["../chunks/calcite-notice"],t,s)))})}get title(){return this.commonMessages?.auth.signIn}render(){const{open:e,title:t,messages:s,signingIn:o,oAuthPrompt:i,server:n,resource:r,error:a}=this,{info:l,oAuthInfo:c,lblItem:u,invalidUser:p,noAuthService:_,lblUser:b,lblPwd:v,lblCancel:I,lblSigning:w,lblOk:x}=s;return d.tsx("div",{class:this.classes(y.base,h.getCalciteThemeClass())},d.tsx("form",{bind:this,onsubmit:this._submit},d.tsx("calcite-modal",{bind:this,open:e,outsideCloseDisabled:!0,scale:"s",widthScale:"s",onCalciteModalClose:this._cancel,onCalciteModalOpen:this._focusUsernameInput},d.tsx("div",{slot:"header"},t),d.tsx("div",{slot:"content"},d.tsx("div",{class:y.info},m.substitute(i?c:l,{server:n&&/\.arcgis\.com/i.test(n)?g:n,resource:`(${r||u})`})),a?d.tsx("calcite-notice",{class:y.notice,icon:"exclamation-mark-triangle",kind:"danger",open:!0},d.tsx("div",{slot:"message"},a.details?.httpStatus?p:_)):null,i?null:[d.tsx("calcite-label",null,b,d.tsx("calcite-input",{afterCreate:e=>this._usernameInputNode=e,autocomplete:"off",bind:this,name:"username",required:!0,spellcheck:!1,type:"text",value:""})),d.tsx("calcite-label",null,v,d.tsx("calcite-input",{afterCreate:e=>this._passwordInputNode=e,bind:this,name:"password",required:!0,type:"password",value:""}))]),d.tsx("calcite-button",{appearance:"outline",bind:this,onclick:this._cancel,slot:"secondary",type:"button",width:"full"},I),d.tsx("calcite-button",{loading:!!o,slot:"primary",type:"submit",width:"full"},o?w:x))))}_focusUsernameInput(){requestAnimationFrame((()=>{this._usernameInputNode?.setFocus()}))}_cancel(){this._set("signingIn",!1),this.open=!1,this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(e){e.preventDefault(),this._set("signingIn",!0);const t=this.oAuthPrompt?{}:{username:this._usernameInputNode?.value,password:this._passwordInputNode?.value};this.emit("submit",t)}};t.__decorate([o.property({readOnly:!0})],b.prototype,"container",void 0),t.__decorate([o.property(),p.messageBundle("esri/t9n/common")],b.prototype,"commonMessages",void 0),t.__decorate([o.property()],b.prototype,"error",void 0),t.__decorate([o.property(),p.messageBundle("esri/identity/t9n/identity")],b.prototype,"messages",void 0),t.__decorate([o.property()],b.prototype,"oAuthPrompt",void 0),t.__decorate([o.property()],b.prototype,"open",void 0),t.__decorate([o.property()],b.prototype,"signingIn",void 0),t.__decorate([o.property()],b.prototype,"server",void 0),t.__decorate([o.property({readOnly:!0})],b.prototype,"title",null),t.__decorate([o.property()],b.prototype,"resource",void 0),b=t.__decorate([a.subclass("esri.identity.IdentityModal")],b);return b}));
