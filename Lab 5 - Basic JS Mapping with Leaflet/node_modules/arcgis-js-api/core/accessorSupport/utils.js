/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../handleUtils","../lang"],(function(r,t,n){"use strict";function e(r){return r.__accessor__??null}function i(r,t){return null!=r?.metadata?.[t]}function o(r,t){const n=e(r);return n?n.getDependsInfo(r,t,""):""}function a(r,t,n){if(n){return u(r,t,{policy:n,path:""})}return u(r,t,null)}function u(r,t,e){return t?Object.keys(t).reduce(((r,i)=>{const o=i;let a=null,l="merge";if(e&&(a=e.path?`${e.path}.${i}`:i,l=e.policy(a)),"replace"===l)return r[o]=t[o],r;if("replace-arrays"===l&&Array.isArray(r[o]))return r[o]=t[o],r;if(void 0===r[o])return r[o]=n.clone(t[o]),r;let s=r[o],c=t[o];if(s===c)return r;if(Array.isArray(c)||Array.isArray(r))s=s?Array.isArray(s)?r[o]=s.concat():r[o]=[s]:r[o]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach((r=>{s.includes(r)||s.push(r)})));else if(c&&"object"==typeof c)if(e){const t=e.path;e.path=a,r[o]=u(s,c,e),e.path=t}else r[o]=u(s,c,null);else r.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(r[o]=c);return r}),r||{}):r}function l(r){return r&&("string"!=typeof r||r.includes("."))?s(r):r}function s(r){return Array.isArray(r)?r:r.split(".")}function c(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function f(r){if(Array.isArray(r)){const t=[];for(const n of r)t.push(...c(n));return t}return c(r)}function p(r){if(!r.includes("?"))return null;const t=s(r),n=new Array(t.length);for(let e=0;e<t.length;e++){const r=t[e];n[e]="?"===r[r.length-1],n[e]&&(t[e]=r.slice(0,-1))}return{fullPath:t.join("."),conditional:n}}function y(r,n,e,i){const o=f(n);if(1!==o.length){const n=o.map((t=>i(r,t,e)));return t.handlesGroup(n)}return i(r,o[0],e)}r.getDependsInfo=o,r.getProperties=e,r.isPropertyDeclared=i,r.merge=a,r.parse=y,r.parseConditionalPath=p,r.pathToArray=s,r.pathToStringOrArray=l,r.splitPath=f,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
