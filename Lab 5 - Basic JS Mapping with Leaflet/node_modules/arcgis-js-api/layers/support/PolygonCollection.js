/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/Collection","../../core/JSONSupport","../../core/Warning","../../core/Logger","../../core/has","../../core/RandomLCG","../../core/Error","../../core/accessorSupport/decorators/subclass","../../geometry/Polygon","../../geometry/projection"],(function(e,t,r,o,s,n,c,a,i,l,p){"use strict";var u;let f=u=class extends(r.JSONSupportMixin(t.ofType(l))){constructor(e){super(e)}clone(){return new u(this.items.map((e=>e.clone())))}write(e,t){return this.toJSON(t)}toJSON(e){const t=e?.layer?.spatialReference;return t?this.toArray().map((r=>{if(!t.equals(r.spatialReference)){if(!p.canProjectWithoutEngine(r.spatialReference,t))return e?.messages&&e.messages.push(new o("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const s=new l;p.projectPolygon(r,s,t),r=s}const s=r.toJSON(e);return delete s.spatialReference,s})).filter((e=>null!=e)):(e?.messages&&e.messages.push(new o("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map((t=>t.toJSON(e))))}static fromJSON(e,t){const r=new u;return e.forEach((e=>r.add(l.fromJSON(e,t)))),r}};f=u=e.__decorate([i.subclass("esri.layers.support.PolygonCollection")],f);return f}));
