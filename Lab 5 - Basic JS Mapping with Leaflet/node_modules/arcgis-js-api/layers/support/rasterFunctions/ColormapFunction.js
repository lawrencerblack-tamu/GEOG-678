/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../rasterFormats/pixelRangeUtils","./BaseRasterFunction","./ColormapFunctionArguments","./colormaps","../../../renderers/support/colorRampUtils"],(function(e,o,r,t,s,p,n,c,a,i,u){"use strict";let l=class extends c{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:o,colormapName:r,colorRamp:t,colorRampName:s}=this.functionArguments;if(!o?.length)if(t)o=u.convertColorRampToColormap(t,{interpolateAlpha:!0});else if(s){const e=u.getColorRampJSON(s);e&&(o=u.convertColorRampToColormap(e))}else r&&(o=i.getColormapByName(r));if(!o?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};const p=this._getOutputPixelType(e.pixelType);this.outputPixelType=p.startsWith("f")?"s32":p;const n=e.clone();return n.pixelType=this.outputPixelType,n.colormap=o,n.bandCount=1,this.rasterInfo=n,{success:!0,supportsGPU:!0}}_processPixels(e){let o=e.pixelBlocks?.[0];return!o||n.isIntegerPixelType(o.pixelType)||(o=o.clone(),o.clamp(this.outputPixelType)),o}};e.__decorate([o.property({json:{write:!0,name:"rasterFunction"}})],l.prototype,"functionName",void 0),e.__decorate([o.property({type:a,json:{write:!0,name:"rasterFunctionArguments"}})],l.prototype,"functionArguments",void 0),e.__decorate([o.property()],l.prototype,"rasterArgumentNames",void 0),e.__decorate([o.property()],l.prototype,"isNoopProcess",void 0),e.__decorate([o.property({json:{write:!0}})],l.prototype,"indexedColormap",void 0),l=e.__decorate([p.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],l);return l}));
