/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../rasterFormats/pixelRangeUtils","./ArithmeticFunctionArguments","./BaseRasterFunction","./localUtils"],(function(e,t,r,s,o,n,i,u,c,p){"use strict";let a=class extends c{constructor(){super(...arguments),this.functionName="Arithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const{operation:e}=this.functionArguments;if(e<1||e>6)return{success:!1,supportsGPU:!1,error:"unsupported operation"};const t=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(t.pixelType),t.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(t),this.rasterInfo=t;return{success:!0,supportsGPU:t.bandCount<=3}}_processPixels(e){const{pixelBlocks:t}=e;return null==t?.[0]||null==t?.[1]?null:p.arithmetic(t,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){const{operation:e}=this.functionArguments,t=["","plus","minus","times","divide","power","mod"][e],r=this.outputPixelType??"f32";let[s,o]=i.getPixelValueRange(r);const n=i.isIntegerPixelType(r);return n&&(s-=1e-4,o+=1e-4),{imageCount:2,operationName:t,domainRange:[s,o],isOutputRounded:n}}};e.__decorate([t.property({json:{write:!0,name:"rasterFunction"}})],a.prototype,"functionName",void 0),e.__decorate([t.property({type:u,json:{write:!0,name:"rasterFunctionArguments"}})],a.prototype,"functionArguments",void 0),e.__decorate([t.property()],a.prototype,"rasterArgumentNames",void 0),a=e.__decorate([n.subclass("esri.layers.support.rasterFunctions.ArithmeticFunction")],a);return a}));
