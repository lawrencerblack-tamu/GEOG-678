/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./BaseRasterFunction","./conversionUtils","./GrayscaleFunctionArguments"],(function(e,t,r,s,o,n,i,c,a){"use strict";let u=class extends i{constructor(){super(...arguments),this.functionName="Grayscale",this.functionArguments=null,this.rasterArgumentNames=["raster"]}get _normalizedWeights(){const{conversionParameters:e}=this.functionArguments,t=e.reduce(((e,t)=>e+t));return e.map((e=>e/t))}_bindSourceRasters(){const{conversionParameters:e}=this.functionArguments;if(!e?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const t=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(t.pixelType),t.pixelType=this.outputPixelType;const r=3===e.length||3===t.bandCount&&e.length>3;return t.bandCount=1,this._removeStatsHistColormapVAT(t),this.rasterInfo=t,{success:!0,supportsGPU:r}}_processPixels(e){const t=e.pixelBlocks?.[0];return null==t?null:c.grayscale(t,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};e.__decorate([t.property({json:{write:!0,name:"rasterFunction"}})],u.prototype,"functionName",void 0),e.__decorate([t.property({type:a,json:{write:!0,name:"rasterFunctionArguments"}})],u.prototype,"functionArguments",void 0),e.__decorate([t.property()],u.prototype,"rasterArgumentNames",void 0),e.__decorate([t.property()],u.prototype,"_normalizedWeights",null),u=e.__decorate([n.subclass("esri.layers.support.rasterFunctions.GrayscaleFunction")],u);return u}));
