/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/Error","../../core/events","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./MediaElementBase"],(function(e,t,o,r,s,n,i,d,a){"use strict";let c=class extends a{constructor(e){super(e),this.autoplay=!0,this.content=null,this.type="video"}load(){const e=this.video;if("string"==typeof e){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then((()=>{this._set("content",t)})))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then((()=>{this._set("content",e)}))):this.addResolvingPromise(Promise.reject(new t("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}get contentWidth(){return this.content?.videoWidth??0}get contentHeight(){return this.content?.videoHeight??0}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):r.getLogger(this).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise(((t,r)=>{const s=o.once(e,"canplay",(()=>{this.removeHandles("canplay"),this.autoplay?e.play().then(t,r):t()}));this.addHandles(s,"canplay"),"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",e.src?.includes("blob:")||(e.src=e.src))}))}};e.__decorate([s.property()],c.prototype,"autoplay",void 0),e.__decorate([s.property({readOnly:!0})],c.prototype,"content",void 0),e.__decorate([s.property({readOnly:!0})],c.prototype,"contentWidth",null),e.__decorate([s.property({readOnly:!0})],c.prototype,"contentHeight",null),e.__decorate([s.property()],c.prototype,"video",null),c=e.__decorate([d.subclass("esri.layers.support.VideoElement")],c);return c}));
