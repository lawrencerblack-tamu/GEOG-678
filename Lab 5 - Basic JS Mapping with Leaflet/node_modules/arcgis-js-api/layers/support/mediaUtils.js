/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../geometry","../../core/accessorSupport/PropertyOrigin","../../geometry/support/spatialReferenceUtils","./ControlPointsGeoreference","../../geometry/Extent","../../geometry/Point"],(function(e,t,n,o,i,r,a){"use strict";const c=100,s=.5;async function l(e,t){e.loaded||await e.load();const{width:n,height:l}=e.content,{spatialReference:y}=t,p=o.getInfo(y);let u=!1;if(p){const e=p.valid[1]-p.valid[0];t.width>e&&(t=new r({xmin:p.valid[0],ymin:t.ymin,xmax:p.valid[1],ymax:t.ymax,spatialReference:t.spatialReference}),u=!0)}const f=t.expand(s),{center:m,width:d,height:x}=f,P=u||n>l?d:n/l*x,g=u||n>l?l/n*d:x,h=m.x-P/2,w=m.x+P/2,R=m.y+g/2,I=m.y-g/2;return new i({controlPoints:[{sourcePoint:{x:c,y:l-c},mapPoint:new a({x:h,y:I,spatialReference:y})},{sourcePoint:{x:c,y:c},mapPoint:new a({x:h,y:R,spatialReference:y})},{sourcePoint:{x:n-c,y:c},mapPoint:new a({x:w,y:R,spatialReference:y})},{sourcePoint:{x:n-c,y:l-c},mapPoint:new a({x:w,y:I,spatialReference:y})}],width:n,height:l})}function y(e){const t=e.georeference;if("control-points"!==t.type)return null;const n={wkid:0},{width:o,height:r}=t,c=t.controlPoints;return new i({controlPoints:c.map((e=>{const{x:t,y:o}=e.sourcePoint;return{sourcePoint:{x:t,y:o},mapPoint:new a({x:t,y:r-o,spatialReference:n})}})),width:o,height:r})}function p(e){return"media"===e?.type}function u(e,t){const o=n.nameToId(t);return p(e)&&!!e.portalItem&&null!=o&&o>n.OriginId.PORTAL_ITEM}e.createDefaultControlPointsGeoreference=l,e.createLocalModeControlPointsGeoreference=y,e.isWritingLayerFromItemToWebDocument=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
