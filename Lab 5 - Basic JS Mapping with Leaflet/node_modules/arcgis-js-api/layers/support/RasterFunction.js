/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","./RasterFunctionTemplate"],(function(e,t,n,r,o,i,s,a,u,c,p){"use strict";var l;const f=new Set(["raster","raster2","dem","fillraster"]),y=new Set(["rasters"]),m=e=>e?.rasterFunction?w.fromJSON(e):e,d=e=>e&&e instanceof w?e.toJSON():e,F=e=>e?.functionName&&!e.declaredClass,h=e=>F(e)?new w(e):e,g=e=>{if(null==e)return null;e=n.clone(e);const t={};for(const n of Object.keys(e))f.has(n.toLowerCase())?t[n]=m(e[n]):y.has(n.toLowerCase())&&Array.isArray(e[n])?t[n]=e[n].map(m):t[n]=e[n];return t},N={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:p}},json:{write:!0,name:"rasterFunctionDefinition"}};let w=l=class extends t.JSONSupport{constructor(e){super(e),this.functionName=null,this.outputPixelType="unknown",this.variableName=null,this.functionDefinition=null}set functionArguments(e){if(e){const t=Object.keys(e);if(t.some((t=>f.has(t.toLowerCase())&&F(e[t])))||t.some((t=>y.has(t.toLowerCase())&&Array.isArray(e[t])&&e[t].some((e=>F(e)))))){e=n.clone(e);for(const n of t)f.has(n.toLowerCase())?e[n]=h(e[n]):y.has(n.toLowerCase())&&Array.isArray(e[n])&&(e[n]=e[n].map((e=>h(e))))}}this._set("functionArguments",e)}readFunctionArguments(e){return g(e)}writeFunctionArguments(e,t,n){const r={};for(const o of Object.keys(e))f.has(o.toLowerCase())?r[o]=d(e[o]):y.has(o.toLowerCase())&&Array.isArray(e[o])?r[o]=e[o].map(d):r[o]=d(e[o]);t[n]=r}readFunctionName(e,t){const n=t.rasterFunctionInfos,r=t.name;return r||(n?.length&&"None"!==n[0].name?n[0].name:t.rasterFunctionDefinition?t.rasterFunctionDefinition.name:t.rasterFunction)}get rasterFunctionDefinition(){return this.functionDefinition?.toJSON()}set rasterFunctionDefinition(e){this.functionDefinition=e?p.fromJSON(e):null}get hasClipFunction(){return this.rasterFunctionDefinition?JSON.stringify(this.rasterFunctionDefinition).includes('"type":"ClipFunction"'):JSON.stringify(this).includes('"rasterFunction":"Clip"')}clone(){return new l({functionName:this.functionName,functionArguments:n.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:n.clone(this.rasterFunctionDefinition)})}};e.__decorate([r.property({json:{type:Object,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",null),e.__decorate([a.reader("functionArguments")],w.prototype,"readFunctionArguments",null),e.__decorate([c.writer("functionArguments")],w.prototype,"writeFunctionArguments",null),e.__decorate([r.property({json:{type:String,write:{target:"rasterFunction"}}})],w.prototype,"functionName",void 0),e.__decorate([a.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],w.prototype,"readFunctionName",null),e.__decorate([s.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),r.property({json:{default:"unknown"}})],w.prototype,"outputPixelType",void 0),e.__decorate([r.property({type:String,json:{read:!0,write:!0}})],w.prototype,"variableName",void 0),e.__decorate([r.property()],w.prototype,"rasterFunctionDefinition",null),e.__decorate([r.property(N)],w.prototype,"functionDefinition",void 0),e.__decorate([r.property()],w.prototype,"hasClipFunction",null),w=l=e.__decorate([u.subclass("esri.layers.support.RasterFunction")],w);return w}));
