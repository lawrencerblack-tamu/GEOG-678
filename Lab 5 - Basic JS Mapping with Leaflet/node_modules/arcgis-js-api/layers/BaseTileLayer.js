/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../request","../core/Error","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../geometry/Extent","../geometry/SpatialReference","../geometry/support/aaBoundingRect","./Layer","./mixins/BlendLayer","./mixins/RefreshableLayer","./mixins/ScaleRangeLayer","./support/imageBitmapUtils","./support/TileInfo","./support/TileKey"],(function(e,t,r,o,a,i,s,l,n,p,c,y,d,u,h,f,g,m){"use strict";var T;const b=new m.TileKey("0/0/0",0,0,0,void 0);let _=T=class extends(d.BlendLayer(h.ScaleRangeLayer(u.RefreshableLayer(y)))){constructor(){super(...arguments),this.tileInfo=g.create({spatialReference:p.WebMercator,size:256}),this.type="base-tile",this.fullExtent=new n(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,p.WebMercator),this.spatialReference=p.WebMercator}getTileBounds(e,t,r,o){const a=o||c.create();return b.level=e,b.row=t,b.col=r,b.extent=a,this.tileInfo.updateTileInfo(b),b.extent=void 0,a}fetchTile(e,r,o,a={}){const{signal:i}=a,s=this.getTileUrl(e,r,o),l={responseType:"image",signal:i,query:{...this.refreshParameters}};return t(s??"",l).then((e=>e.data))}async fetchImageBitmapTile(e,r,o,a={}){const{signal:i}=a;if(this.fetchTile!==T.prototype.fetchTile){const t=await this.fetchTile(e,r,o,a);return f.createTileBitmap(t,e,r,o,i)}const s=this.getTileUrl(e,r,o)??"",l={responseType:"blob",signal:i,query:{...this.refreshParameters}},{data:n}=await t(s,l);return f.createTileBitmap(n,e,r,o,i)}getTileUrl(){throw new r("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented")}};e.__decorate([o.property({type:g})],_.prototype,"tileInfo",void 0),e.__decorate([o.property({type:["show","hide"]})],_.prototype,"listMode",void 0),e.__decorate([o.property({readOnly:!0,value:"base-tile"})],_.prototype,"type",void 0),e.__decorate([o.property({nonNullable:!0})],_.prototype,"fullExtent",void 0),e.__decorate([o.property()],_.prototype,"spatialReference",void 0),_=T=e.__decorate([l.subclass("esri.layers.BaseTileLayer")],_);return _}));
