/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./utils","../../portal/support/portalItemUtils"],(function(e,t,r){"use strict";const a="Image Service",i="imagery-layer-save",s="imagery-layer-save-as",y="imagery-tile-layer-save",l="imagery-tile-layer-save-as";function n(e){if("imagery"===e.type)return{isValid:!0};const{raster:t}=e,r="Function"===t?.datasetFormat?t.primaryRasters?.rasters[0]:t;return{isValid:"RasterTileServer"===r?.datasetFormat&&("Raster"===r.tileType||"Map"===r.tileType),errorMessage:"imagery tile layer should be created from a tiled image service."}}function o(e){const t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}async function m(e,t){const{parsedUrl:a,title:i,fullExtent:s}=e;t.url=a.path,t.title||=i;try{t.extent=await r.getWGS84ExtentForItem(s)}catch{t.extent=void 0}r.removeTypeKeyword(t,r.typeKeyword.METADATA),"imagery-tile"===e.type&&r.addTypeKeyword(t,r.typeKeyword.TILED_IMAGERY)}async function c(e,r){const s="imagery"===e.type?i:y,l={layer:e,itemType:a,validateLayer:n,createItemData:o,errorNamePrefix:s};return t.save(l,r)}async function p(e,r,i){const y="imagery"===e.type?s:l,c={layer:e,itemType:a,validateLayer:n,createItemData:o,errorNamePrefix:y,newItem:r,setItemProperties:m};return t.saveAs(c,i)}e.save=c,e.saveAs=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
