/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./utils","../../portal/support/jsonContext","../../portal/support/portalItemUtils","../../webdoc/support/resourceUtils"],(function(e,r,t,o,s){"use strict";const a="Group Layer",n="group-layer-save",c="group-layer-save-as",u=o.typeKeyword.GROUP_LAYER_MAP;function i(e){return{isValid:"group"===e.type,errorMessage:"Layer.type should be 'group'"}}function y(e){return{isValid:o.hasTypeKeyword(e,u),errorMessage:`Layer.portalItem.typeKeywords should have '${u}'`}}function l(e,r){return{...t.createForItemWrite(e,"web-map",!0),initiator:r}}function p(e){const r=e.layerJSON;return Promise.resolve(r&&Object.keys(r).length?r:null)}async function d(e,r){r.title||=e.title,o.removeTypeKeyword(r,o.typeKeyword.METADATA),o.addTypeKeyword(r,u)}async function m(e,t){const o={layer:e,itemType:a,validateLayer:i,validateItem:y,createJSONContext:r=>l(r,e),createItemData:p,errorNamePrefix:n,saveResources:async(r,t)=>(e.sourceIsPortalItem||await r.removeAllResources().catch((()=>{})),s.saveResources(e.resourceReferences,t))};return r.save(o,t)}async function v(e,t,o){const n={layer:e,itemType:a,validateLayer:i,createJSONContext:r=>l(r,e),createItemData:p,errorNamePrefix:c,newItem:t,setItemProperties:d,saveResources:(r,t)=>s.saveResources(e.resourceReferences,t)};return r.saveAs(n,o)}e.save=m,e.saveAs=v,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
