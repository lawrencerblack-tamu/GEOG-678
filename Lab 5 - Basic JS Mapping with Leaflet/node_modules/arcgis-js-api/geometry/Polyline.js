/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","./Extent","./Geometry","./Point","./SpatialReference","./support/extentUtils","./support/zmUtils"],(function(t,e,r,s,i,n,a,o,h,p,l,c,u){"use strict";var y;function f(t){return!Array.isArray(t[0])}let d=y=class extends h{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let r,s,i=null,n=null;return t&&!Array.isArray(t)?(i=t.paths??null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),r=t.hasZ,s=t.hasM):i=t,i=i||[],e=e||l.WGS84,i.length&&null!=i[0]?.[0]&&"number"==typeof i[0][0]&&(i=[i]),n=i[0]?.[0],n&&(void 0===r&&void 0===s?(r=n.length>2,s=!1):void 0===r?r=!s&&n.length>3:void 0===s&&(s=!r&&n.length>3)),{paths:i,spatialReference:e,hasZ:r,hasM:s}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=c.getPolylineExtent(this);if(!e)return null;const r=new o(e);return r.spatialReference=t,r}writePaths(t,r){r.paths=e.clone(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(f(t)){const s=[];for(let e=0,r=t.length;e<r;e++)s[e]=t[e].toArray();e[r]=s}else e[r]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new y;return t.spatialReference=this.spatialReference,t.paths=e.clone(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],s=this.hasZ,i=this.hasM;return s&&!i?new p(r[0],r[1],r[2],void 0,this.spatialReference):i&&!s?new p(r[0],r[1],void 0,r[2],this.spatialReference):s&&i?new p(r[0],r[1],r[2],r[3],this.spatialReference):new p(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(u.updateSupportFromPoint(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,s=e.map((t=>new p(t,r)));return this.notifyChange("paths"),s}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new p(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(u.updateSupportFromPoint(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const s=this.paths[t];if(r&&(e<0||e>s.length))return!1;if(!r&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};t.__decorate([r.property({readOnly:!0})],d.prototype,"cache",null),t.__decorate([r.property({readOnly:!0})],d.prototype,"extent",null),t.__decorate([r.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],d.prototype,"paths",void 0),t.__decorate([a.writer("paths")],d.prototype,"writePaths",null),d=y=t.__decorate([n.subclass("esri.geometry.Polyline")],d),d.prototype.toJSON.isDefaultToJSON=!0;return d}));
