/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","../../core/mathUtils","../../core/unitUtils","../ellipsoidUtils","../support/Ellipsoid","../support/geodesicConstants","../support/spatialReferenceUtils","../support/SupportedGCSWkids"],(function(o,e,n,t,r,P,c,i){"use strict";var l;o.ProjectionID=void 0,(l=o.ProjectionID||(o.ProjectionID={}))[l.UNKNOWN=0]="UNKNOWN",l[l.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",l[l.WGS84=2]="WGS84",l[l.WEB_MERCATOR=3]="WEB_MERCATOR",l[l.WGS84_ECEF=4]="WGS84_ECEF",l[l.CGCS2000=5]="CGCS2000",l[l.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",l[l.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",l[l.GCSMARS2000=8]="GCSMARS2000",l[l.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",l[l.GCSMOON2000=10]="GCSMOON2000",l[l.LON_LAT=11]="LON_LAT",l[l.PLATE_CARREE=12]="PLATE_CARREE";const C={[o.ProjectionID.WGS84]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:j,[o.ProjectionID.SPHERICAL_ECEF]:h,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:u,[o.ProjectionID.PLATE_CARREE]:O,[o.ProjectionID.WGS84]:j,[o.ProjectionID.WGS84_ECEF]:g},[o.ProjectionID.CGCS2000]:{[o.ProjectionID.CGCS2000]:j,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:j,[o.ProjectionID.SPHERICAL_ECEF]:h,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:O,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:g},[o.ProjectionID.GCSMARS2000]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:j,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:null,[o.ProjectionID.SPHERICAL_ECEF]:null,[o.ProjectionID.SPHERICAL_MARS_PCPF]:f,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:null,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:null},[o.ProjectionID.GCSMOON2000]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:j,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:null,[o.ProjectionID.SPHERICAL_ECEF]:null,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:p,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:null,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:null},[o.ProjectionID.WEB_MERCATOR]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:A,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:A,[o.ProjectionID.SPHERICAL_ECEF]:D,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:j,[o.ProjectionID.PLATE_CARREE]:s,[o.ProjectionID.WGS84]:A,[o.ProjectionID.WGS84_ECEF]:_},[o.ProjectionID.WGS84_ECEF]:{[o.ProjectionID.CGCS2000]:b,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:b,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:b,[o.ProjectionID.SPHERICAL_ECEF]:k,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:q,[o.ProjectionID.PLATE_CARREE]:M,[o.ProjectionID.WGS84]:b,[o.ProjectionID.WGS84_ECEF]:j},[o.ProjectionID.SPHERICAL_ECEF]:{[o.ProjectionID.CGCS2000]:U,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:U,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:U,[o.ProjectionID.SPHERICAL_ECEF]:j,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:K,[o.ProjectionID.PLATE_CARREE]:N,[o.ProjectionID.WGS84]:U,[o.ProjectionID.WGS84_ECEF]:w},[o.ProjectionID.SPHERICAL_MARS_PCPF]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:B,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:B,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:null,[o.ProjectionID.SPHERICAL_ECEF]:null,[o.ProjectionID.SPHERICAL_MARS_PCPF]:j,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:null,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:null},[o.ProjectionID.SPHERICAL_MOON_PCPF]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:H,[o.ProjectionID.LON_LAT]:H,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:null,[o.ProjectionID.SPHERICAL_ECEF]:null,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:j,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:null,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:null},[o.ProjectionID.UNKNOWN]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:null,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:null,[o.ProjectionID.SPHERICAL_ECEF]:null,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:j,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:null,[o.ProjectionID.WGS84]:null,[o.ProjectionID.WGS84_ECEF]:null},[o.ProjectionID.LON_LAT]:{[o.ProjectionID.CGCS2000]:j,[o.ProjectionID.GCSMARS2000]:j,[o.ProjectionID.GCSMOON2000]:j,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:j,[o.ProjectionID.SPHERICAL_ECEF]:h,[o.ProjectionID.SPHERICAL_MARS_PCPF]:f,[o.ProjectionID.SPHERICAL_MOON_PCPF]:p,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:u,[o.ProjectionID.PLATE_CARREE]:O,[o.ProjectionID.WGS84]:j,[o.ProjectionID.WGS84_ECEF]:g},[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:{[o.ProjectionID.CGCS2000]:null,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:j,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:j,[o.ProjectionID.SPHERICAL_ECEF]:h,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:null,[o.ProjectionID.PLATE_CARREE]:O,[o.ProjectionID.WGS84]:j,[o.ProjectionID.WGS84_ECEF]:g},[o.ProjectionID.PLATE_CARREE]:{[o.ProjectionID.CGCS2000]:L,[o.ProjectionID.GCSMARS2000]:null,[o.ProjectionID.GCSMOON2000]:null,[o.ProjectionID.LON_LAT]:L,[o.ProjectionID.WGS84_COMPARABLE_LON_LAT]:L,[o.ProjectionID.SPHERICAL_ECEF]:G,[o.ProjectionID.SPHERICAL_MARS_PCPF]:null,[o.ProjectionID.SPHERICAL_MOON_PCPF]:null,[o.ProjectionID.UNKNOWN]:null,[o.ProjectionID.WEB_MERCATOR]:W,[o.ProjectionID.PLATE_CARREE]:j,[o.ProjectionID.WGS84]:L,[o.ProjectionID.WGS84_ECEF]:F}};function I(e){const n=S(e,x);return C[n][o.ProjectionID.WGS84_COMPARABLE_LON_LAT]}function E(o,e,n=v()){return null==o||null==e?null:y(o,e,n).projector}function a(o,e){switch(E(o,e,J)){case j:return"copy3";case h:return"wgs84ToSphericalECEF";case u:return"wgs84ToWebMercator";case O:return"wgs84ToPlateCarree";case g:return"wgs84ToWGS84ECEF";case A:return"webMercatorToWGS84";case D:return"webMercatorToSphericalECEF";case _:return"webMercatorToWGS84ECEF";case s:return"webMercatorToPlateCarree";case b:return"wgs84ECEFToWGS84";case k:return"wgs84ECEFToSphericalECEF";case q:return"wgs84ECEFToWebMercator";case U:return"sphericalECEFToWGS84";case K:return"sphericalECEFToWebMercator";case B:return"sphericalMarsPCPFToMars2000";case H:return"sphericalMoonPCPFToMoon2000";case w:return"sphericalECEFToWGS84ECEF";case f:return"mars2000ToSphericalPCPF";case p:return"moon2000ToSphericalPCPF";default:return null}}function S(e,r){return e?r.spatialReference===e?r.spatialReferenceId:(r.spatialReference=e,"metersPerUnit"in r&&(r.metersPerUnit=n.getMetersPerUnitForSR(e,1)),t.isSphericalECEF(e)?r.spatialReferenceId=o.ProjectionID.SPHERICAL_ECEF:c.isWGS84(e)?r.spatialReferenceId=o.ProjectionID.WGS84:c.isWebMercator(e)?r.spatialReferenceId=o.ProjectionID.WEB_MERCATOR:c.isPlateCarree(e)?r.spatialReferenceId=o.ProjectionID.PLATE_CARREE:e.wkt===t.WGS84ECEFSpatialReferenceLike.wkt?r.spatialReferenceId=o.ProjectionID.WGS84_ECEF:e.wkid===i.SupportedGCSWkids.CGCS2000?r.spatialReferenceId=o.ProjectionID.CGCS2000:e.wkt===t.SphericalPCPFMarsLike.wkt?r.spatialReferenceId=o.ProjectionID.SPHERICAL_MARS_PCPF:e.wkt===t.SphericalPCPFMoonLike.wkt?r.spatialReferenceId=o.ProjectionID.SPHERICAL_MOON_PCPF:c.isMars(e)?r.spatialReferenceId=o.ProjectionID.GCSMARS2000:c.isMoon(e)?r.spatialReferenceId=o.ProjectionID.GCSMOON2000:r.spatialReferenceId=o.ProjectionID.UNKNOWN):o.ProjectionID.UNKNOWN}function j(o,e,n,t){o!==n&&(n[t++]=o[e++],n[t++]=o[e++],n[t]=o[e])}function A(o,e,n,t){n[t]=V*(o[e]/Z),n[t+1]=V*(Y-2*Math.atan(Math.exp(-o[e+1]/Z))),n[t+2]=o[e+2]}function D(o,e,n,t){const r=o[e]/Z,P=Y-2*Math.atan(Math.exp(-o[e+1]/Z)),c=Z+o[e+2],i=Math.cos(P)*c;n[t]=Math.cos(r)*i,n[t+1]=Math.sin(r)*i,n[t+2]=Math.sin(P)*c}function _(o,e,n,t){A(o,e,n,t),g(n,t,n,t)}function R(o,n,t,r,P){const c=.4999999*X,i=e.clamp(Q*o[n+1],-c,c),l=Math.sin(i);t[r++]=Q*o[n]*P.radius,t[r++]=P.halfSemiMajorAxis*Math.log((1+l)/(1-l)),t[r]=o[n+2]}function u(o,e,n,t){R(o,e,n,t,r.earth)}function O(o,e,n,t){n[t]=o[e]*$,n[t+1]=o[e+1]*$,n[t+2]=o[e+2]}function L(o,e,n,t){n[t]=o[e]*oo,n[t+1]=o[e+1]*oo,n[t+2]=o[e+2]}function s(o,e,n,t){A(o,e,n,t),O(n,t,n,t)}function M(o,e,n,t){b(o,e,n,t),O(n,t,n,t)}function N(o,e,n,t){U(o,e,n,t),O(n,t,n,t)}function G(o,e,n,t){L(o,e,n,t),h(n,t,n,t)}function W(o,e,n,t){L(o,e,n,t),u(n,t,n,t)}function F(o,e,n,t){L(o,e,n,t),g(n,t,n,t)}function T(o,e,n,t,r){const P=r+o[e+2],c=Q*o[e+1],i=Q*o[e],l=Math.cos(c)*P;n[t]=Math.cos(i)*l,n[t+1]=Math.sin(i)*l,n[t+2]=Math.sin(c)*P}function p(o,e,n,t){T(o,e,n,t,r.moon.radius)}function f(o,e,n,t){T(o,e,n,t,r.mars.radius)}function h(o,e,n,t){T(o,e,n,t,r.earth.radius)}function d(o,n,t,r,P){const c=o[n],i=o[n+1],l=o[n+2],C=Math.sqrt(c*c+i*i+l*l),I=e.asinClamped(l/(0===C?1:C)),E=Math.atan2(i,c);t[r++]=V*E,t[r++]=V*I,t[r]=C-P}function H(o,e,n,t){d(o,e,n,t,r.moon.radius)}function B(o,e,n,t){d(o,e,n,t,r.mars.radius)}function U(o,e,n,t){d(o,e,n,t,r.earth.radius)}function K(o,e,n,t){U(o,e,n,t),u(n,t,n,t)}function w(o,e,n,t){U(o,e,n,t),g(n,t,n,t)}function m(o,e,n,t,r){const P=Q*o[e],c=Q*o[e+1],i=o[e+2],l=Math.sin(c),C=Math.cos(c),I=r.radius/Math.sqrt(1-r.eccentricitySquared*l*l);n[t++]=(I+i)*C*Math.cos(P),n[t++]=(I+i)*C*Math.sin(P),n[t++]=(I*(1-r.eccentricitySquared)+i)*l}function g(o,e,n,t){m(o,e,n,t,r.earth)}function b(o,e,n,t){const c=P.earthEllipsoidConstants,i=o[e],l=o[e+1],C=o[e+2];let I,E,a,S,j,A,D,_,R,u,O,L,s,M,N,G,W,F,T,p,f;I=Math.abs(C),E=i*i+l*l,a=Math.sqrt(E),S=E+C*C,j=Math.sqrt(S),p=Math.atan2(l,i),A=C*C/S,D=E/S,M=c.a2/j,N=c.a3-c.a4/j,D>.3?(_=I/j*(1+D*(c.a1+M+A*N)/j),T=Math.asin(_),u=_*_,R=Math.sqrt(1-u)):(R=a/j*(1-A*(c.a5-M-D*N)/j),T=Math.acos(R),u=1-R*R,_=Math.sqrt(u)),O=1-r.earth.eccentricitySquared*u,L=r.earth.radius/Math.sqrt(O),s=c.a6*L,M=a-L*R,N=I-s*_,W=R*M+_*N,G=R*N-_*M,F=G/(s/O+W),T+=F,f=W+G*F/2,C<0&&(T=-T),n[t++]=V*p,n[t++]=V*T,n[t]=f}function k(o,e,n,t){b(o,e,n,t),h(n,t,n,t)}function q(o,e,n,t){b(o,e,n,t),u(n,t,n,t)}function y(e,n,t){if(null==e||null==n||t.source.spatialReference===e&&t.dest.spatialReference===n)return t;const r=S(e,t.source),P=S(n,t.dest);return r===o.ProjectionID.UNKNOWN&&P===o.ProjectionID.UNKNOWN?c.equals(e,n)?t.projector=j:t.projector=null:t.projector=C[r][P],t}function v(){return{source:{spatialReference:null,spatialReferenceId:o.ProjectionID.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:o.ProjectionID.UNKNOWN,metersPerUnit:1},projector:j}}const x={spatialReference:null,spatialReferenceId:o.ProjectionID.UNKNOWN},z={spatialReference:null,spatialReferenceId:o.ProjectionID.UNKNOWN},J=v(),Q=e.deg2rad(1),V=e.rad2deg(1),X=Math.PI,Y=.5*X,Z=r.earth.radius,$=Z*X/180,oo=180/(Z*X);o.classifySpatialReference=S,o.copy3=j,o.createEmptyProjectorCache=v,o.destClassificationCache=z,o.getProjector=E,o.getProjectorName=a,o.getWGS84ComparableLonLatProjector=I,o.invPlateCarreeScale=oo,o.lonLatToWebMercatorComparable=R,o.populateProjectorCache=y,o.projectionTable=C,o.projectorCache=J,o.sourceClassificationCache=x,o.sphericalPCPFtoLonLatElevation=d,o.wgs84ToWebMercator=u,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));
