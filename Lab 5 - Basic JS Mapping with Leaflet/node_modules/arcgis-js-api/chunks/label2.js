/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./dom","./component"],(function(e,t,n){"use strict";
/*!
     * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
     * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
     * v2.4.0
     */const l="calciteInternalLabelClick",o="calciteInternalLabelConnected",s="calciteInternalLabelDisconnected",a="calcite-label",i=new WeakMap,c=new WeakMap,r=new WeakMap,d=new WeakMap,u=new Set,b=e=>{const{id:n}=e,l=n&&t.queryElementRoots(e,{selector:`${a}[for="${n}"]`});if(l)return l;const o=t.closestElementCrossShadowBoundary(e,a);return!o||E(o,e)?null:o};function E(e,t){let n;const l="custom-element-ancestor-check",o=l=>{l.stopImmediatePropagation();const o=l.composedPath();n=o.slice(o.indexOf(t),o.indexOf(e))};e.addEventListener(l,o,{once:!0}),t.dispatchEvent(new CustomEvent(l,{composed:!0,bubbles:!0})),e.removeEventListener(l,o);return n.filter((n=>n!==t&&n!==e)).filter((e=>e.tagName?.includes("-"))).length>0}function f(e){if(!e)return;const t=b(e.el);if(c.has(t)&&t===e.labelEl||!t&&u.has(e))return;const n=p.bind(e);if(t){e.labelEl=t;const a=i.get(t)||[];a.push(e),i.set(t,a.sort(v)),c.has(e.labelEl)||(c.set(e.labelEl,L),e.labelEl.addEventListener(l,L)),u.delete(e),document.removeEventListener(o,r.get(e)),d.set(e,n),document.addEventListener(s,n)}else u.has(e)||(n(),document.removeEventListener(s,d.get(e)))}function m(e){if(!e)return;if(u.delete(e),document.removeEventListener(o,r.get(e)),document.removeEventListener(s,d.get(e)),r.delete(e),d.delete(e),!e.labelEl)return;const t=i.get(e.labelEl);1===t.length&&(e.labelEl.removeEventListener(l,c.get(e.labelEl)),c.delete(e.labelEl)),i.set(e.labelEl,t.filter((t=>t!==e)).sort(v)),e.labelEl=null}function v(e,n){return t.isBefore(e.el,n.el)?-1:1}function h(e){return e.label||e.labelEl?.textContent?.trim()||""}function L(e){const t=e.detail.sourceEvent.target,n=i.get(this),l=n.find((e=>e.el===t));if(n.includes(l))return;const o=n[0];o.disabled||o.onLabelClick(e)}function g(){u.has(this)&&f(this)}function p(){u.add(this);const e=r.get(this)||g.bind(this);r.set(this,e),document.addEventListener(o,e)}async function w(e){await n.componentOnReady(e);if(i.has(e))return;const t=e.ownerDocument?.getElementById(e.for);t&&requestAnimationFrame((()=>{for(const e of u)if(e.el===t){f(e);break}}))}e.associateExplicitLabelToUnlabeledComponent=w,e.connectLabel=f,e.disconnectLabel=m,e.getLabelText=h,e.labelConnectedEvent=o,e.labelDisconnectedEvent=s}));
