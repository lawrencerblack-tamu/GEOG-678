/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
define(["exports","./dom","./componentsUtils"],(function(e,t,n){"use strict";
/*!
     * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
     * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
     * v2.4.0
     */const o=["calcite-input","calcite-input-number","calcite-input-text","calcite-text-area"],a="hidden-form-input";function i(e){return"checked"in e}const s=new WeakMap,r=new WeakSet;function c(e,n){if(t.closestElementCrossShadowBoundary(n.parentElement,"[form]"))return!0;const o="calciteInternalFormComponentRegister";let a=!1;return e.addEventListener(o,(e=>{a=e.composedPath().some((e=>r.has(e))),e.stopPropagation()}),{once:!0}),n.dispatchEvent(new CustomEvent(o,{bubbles:!0,composed:!0})),a}function l(e){"status"in e&&(e.status="idle"),"validationIcon"in e&&(e.validationIcon=!1),"validationMessage"in e&&(e.validationMessage="")}function u(e,t){"status"in e&&(e.status="invalid"),"validationIcon"in e&&(e.validationIcon=!0),"validationMessage"in e&&(e.validationMessage=t)}function d(e){const t=e?.target,n=t?.parentElement,a=n?.nodeName?.toLowerCase(),i=a?.split("-");if(i.length<2||"calcite"!==i[0])return;e?.preventDefault(),u(n,t?.validationMessage||"");const s=`${i.map(((e,t)=>0===t?e:`${e[0].toUpperCase()}${e.slice(1)}`)).join("")}${o.includes(a)?"Input":"Change"}`;n.addEventListener(s,(()=>l(n)),{once:!0})}function m(e){const{formEl:t}=e;return!!t&&(t.addEventListener("invalid",d,!0),t.requestSubmit(),t.removeEventListener("invalid",d,!0),requestAnimationFrame((()=>{const e=t.querySelectorAll("[status=invalid]");for(const t of e)if(t?.validationMessage){t?.setFocus();break}})),!0)}function f(e){e.formEl?.reset()}function v(e){const{el:t,value:n}=e,o=p(e);if(!o||c(o,t))return;e.formEl=o,e.defaultValue=n,i(e)&&(e.defaultChecked=e.checked);const a=(e.onFormReset||h).bind(e);o.addEventListener("reset",a),s.set(e.el,a),r.add(t)}function p(e){const{el:n,form:o}=e;return o?t.queryElementRoots(n,{id:o}):t.closestElementCrossShadowBoundary(n,"form")}function h(){l(this),i(this)?this.checked=this.defaultChecked:this.value=this.defaultValue}function E(e){const{el:t,formEl:n}=e;if(!n)return;const o=s.get(t);n.removeEventListener("reset",o),s.delete(t),e.formEl=null,r.delete(t)}function b(e,t){e.defaultValue=t}const g="calciteInternalHiddenInputInput",I=e=>{e.target.dispatchEvent(new CustomEvent(g,{bubbles:!0}))},k=e=>e.removeEventListener("input",I);function C(e){const{el:t,formEl:n,name:o,value:i}=e,{ownerDocument:s}=t,r=t.querySelectorAll(`input[slot="${a}"]`);if(!n||!o)return void r.forEach((e=>{k(e),e.remove()}));const c=Array.isArray(i)?i:[i],l=[],u=new Set;let d;r.forEach((t=>{const n=c.find((e=>e==t.value));null!=n?(u.add(n),F(e,t,n)):l.push(t)})),c.forEach((t=>{if(u.has(t))return;let n=l.pop();n||(n=s.createElement("input"),n.slot=a),d||(d=s.createDocumentFragment()),d.append(n),n.addEventListener("input",I),F(e,n,t)})),d&&t.append(d),l.forEach((e=>{k(e),e.remove()}))}function F(e,t,n){const{defaultValue:o,disabled:a,form:s,name:r,required:c}=e;t.defaultValue=o,t.disabled=a,t.name=r,t.required=c,t.tabIndex=-1,s?t.setAttribute("form",s):t.removeAttribute("form"),i(e)?(t.checked=e.checked,t.defaultChecked=e.defaultChecked,t.value=e.checked?n||"on":""):t.value=n||"",e.syncHiddenFormInput?.(t)}const w=({component:e})=>(C(e),n.h("slot",{name:a}));e.HiddenFormInputSlot=w,e.afterConnectDefaultValueSet=b,e.connectForm=v,e.disconnectForm=E,e.findAssociatedForm=p,e.internalHiddenInputInputEvent=g,e.resetForm=f,e.submitForm=m}));
